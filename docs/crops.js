(()=>{"use strict";const e=JSON.parse('[{"name":"Blue Jazz","season":"Spring","seed_cost":30,"sell_price":50,"days_to_grow":7},{"name":"Carrot","season":"Spring","seed_cost":0,"sell_price":35,"days_to_grow":3},{"name":"Cauliflower","season":"Spring","seed_cost":80,"sell_price":175,"days_to_grow":12},{"name":"Coffee Bean","season":"Spring","multiseason":2,"seed_cost":15,"sell_price":15,"days_to_grow":10,"regrowth_period":2,"yield":4,"percent_chance_extra":2},{"name":"Garlic","season":"Spring","seed_cost":40,"sell_price":60,"days_to_grow":4},{"name":"Green Bean","season":"Spring","seed_cost":60,"sell_price":40,"days_to_grow":10,"regrowth_period":3},{"name":"Kale","season":"Spring","seed_cost":70,"sell_price":110,"days_to_grow":6},{"name":"Parsnip","season":"Spring","seed_cost":20,"sell_price":35,"days_to_grow":4},{"name":"Potato","season":"Spring","seed_cost":50,"sell_price":80,"days_to_grow":6,"percent_chance_extra":25},{"name":"Rhubarb","season":"Spring","seed_cost":100,"sell_price":220,"days_to_grow":13},{"name":"Rice","season":"Spring","seed_cost":40,"sell_price":30,"days_to_grow":6},{"name":"Strawberry","season":"Spring","seed_cost":100,"sell_price":120,"days_to_grow":8,"regrowth_period":4,"percent_chance_extra":2},{"name":"Tulip","season":"Spring","seed_cost":20,"sell_price":30,"days_to_grow":6},{"name":"Blueberry","season":"Summer","seed_cost":80,"sell_price":50,"days_to_grow":13,"regrowth_period":4,"yield":3,"percent_chance_extra":2},{"name":"Corn","season":"Summer","multiseason":2,"seed_cost":150,"sell_price":50,"days_to_grow":14,"regrowth_period":4},{"name":"Hops","season":"Summer","seed_cost":60,"sell_price":25,"days_to_grow":11,"regrowth_period":1},{"name":"Hot Pepper","season":"Summer","seed_cost":40,"sell_price":40,"days_to_grow":5,"regrowth_period":3,"percent_chance_extra":3},{"name":"Melon","season":"Summer","seed_cost":80,"sell_price":250,"days_to_grow":12},{"name":"Poppy","season":"Summer","seed_cost":100,"sell_price":140,"days_to_grow":7},{"name":"Radish","season":"Summer","seed_cost":40,"sell_price":90,"days_to_grow":6},{"name":"Red Cabbage","season":"Summer","seed_cost":100,"sell_price":260,"days_to_grow":9},{"name":"Starfruit","season":"Summer","seed_cost":400,"sell_price":750,"days_to_grow":13},{"name":"Summer Spangle","season":"Summer","seed_cost":50,"sell_price":90,"days_to_grow":8},{"name":"Summer Squash","season":"Summer","seed_cost":0,"sell_price":45,"days_to_grow":6},{"name":"Sunflower","season":"Summer","multiseason":2,"seed_cost":200,"sell_price":80,"days_to_grow":8},{"name":"Tomato","season":"Summer","seed_cost":50,"sell_price":60,"days_to_grow":11,"regrowth_period":4,"percent_chance_extra":5},{"name":"Wheat","season":"Summer","multiseason":2,"seed_cost":10,"sell_price":25,"days_to_grow":4},{"name":"Amaranth","season":"Fall","seed_cost":70,"sell_price":150,"days_to_grow":7},{"name":"Artichoke","season":"Fall","seed_cost":30,"sell_price":160,"days_to_grow":8},{"name":"Beet","season":"Fall","seed_cost":20,"sell_price":100,"days_to_grow":6},{"name":"Bok Choy","season":"Fall","seed_cost":50,"sell_price":80,"days_to_grow":4},{"name":"Broccoli","season":"Fall","seed_cost":0,"sell_price":70,"days_to_grow":8},{"name":"Cranberries","season":"Fall","seed_cost":240,"sell_price":75,"days_to_grow":7,"regrowth_period":5,"yield":2,"percent_chance_extra":10},{"name":"Eggplant","season":"Fall","seed_cost":20,"sell_price":60,"days_to_grow":5,"regrowth_period":5,"percent_chance_extra":0.2},{"name":"Fairy Rose","season":"Fall","seed_cost":200,"sell_price":290,"days_to_grow":12},{"name":"Grape","season":"Fall","seed_cost":60,"sell_price":80,"days_to_grow":10,"regrowth_period":3},{"name":"Pumpkin","season":"Fall","seed_cost":100,"sell_price":320,"days_to_grow":13},{"name":"Yam","season":"Fall","seed_cost":60,"sell_price":160,"days_to_grow":10},{"name":"Powdermelon","season":"Winter","seed_cost":0,"sell_price":60,"days_to_grow":7}]');var t;!function(e){e[e.SPRING=0]="SPRING",e[e.SUMMER=1]="SUMMER",e[e.FALL=2]="FALL",e[e.WINTER=3]="WINTER"}(t||(t={})),function(e){e.fromString=function(t){switch(t.toUpperCase()){case"SPRING":return e.SPRING;case"SUMMER":return e.SUMMER;case"FALL":return e.FALL;case"WINTER":return e.WINTER;default:throw new Error(`Unknown season ${t}`)}}}(t||(t={}));const o=1.25,r=1.5,s=2;function n(e,n){var a,i,l;let _=[],d=null!==(a=e.multiseason)&&void 0!==a?a:1;for(let o=0;o<d;o++)_.push(t.fromString(e.season).valueOf()+o);if(!_.includes(n.season))return"out-of-season";let c=28*(n.multiseason_enabled?_.length-_.indexOf(n.season):1)-n.start_day,m=0,p=0;if(c>=e.days_to_grow&&(m+=1,p+=e.days_to_grow,e.regrowth_period)){let t=Math.floor((c-e.days_to_grow)/e.regrowth_period);m+=t,p+=t*e.regrowth_period}let u,g=e.sell_price;if(n.quality_probabilities){let e=n.quality_probabilities;u=[[1,e.normal],[o,e.silver],[r,e.gold],[s,e.iridium]].map((([e,t])=>Math.trunc(e*g)*t)).reduce(((e,t)=>e+t))}else u=g;let w=(null!==(i=e.yield)&&void 0!==i?i:1)+(null!==(l=e.percent_chance_extra)&&void 0!==l?l:0)/100,y=(u+(w-1)*g)*m-e.seed_cost;return{definition:e,useful_days:p,num_harvests:m,num_crops:w*m,profit:y,daily_profit:y/p}}const a=[{name:"Name",cellText:e=>e.definition.name,compare:(e,t)=>e.definition.name.localeCompare(t.definition.name)},{name:"Seed Cost",cellText:e=>e.definition.seed_cost.toString(),compare:(e,t)=>e.definition.seed_cost-t.definition.seed_cost},{name:"Sell Price",cellText:e=>e.definition.sell_price.toString(),compare:(e,t)=>e.definition.sell_price-t.definition.sell_price},{name:"Days to Grow",cellText:e=>e.definition.days_to_grow.toString(),compare:(e,t)=>e.definition.days_to_grow-t.definition.days_to_grow},{name:"Regrowth Period",cellText:e=>{var t,o;return null!==(o=null===(t=e.definition.regrowth_period)||void 0===t?void 0:t.toString())&&void 0!==o?o:"-"},compare:(e,t)=>void 0===t.definition.regrowth_period?-1:void 0===e.definition.regrowth_period?1:e.definition.regrowth_period-t.definition.regrowth_period},{name:"Yield",cellText:e=>{var t;let o=null!==(t=e.definition.yield)&&void 0!==t?t:1;return e.definition.percent_chance_extra?`${o} + ${e.definition.percent_chance_extra}%`:o.toString()},compare:(e,t)=>{var o,r,s,n;return(null!==(o=e.definition.yield)&&void 0!==o?o:1)+(null!==(r=e.definition.percent_chance_extra)&&void 0!==r?r:0)/100-((null!==(s=t.definition.yield)&&void 0!==s?s:1)+(null!==(n=t.definition.percent_chance_extra)&&void 0!==n?n:0)/100)}},{name:"Useful Days",cellText:e=>e.useful_days.toString(),compare:(e,t)=>e.useful_days-t.useful_days},{name:"Num Harvests",cellText:e=>e.num_harvests.toString(),compare:(e,t)=>e.num_crops-t.num_crops},{name:"Num Crops",cellText:e=>{let t=e.num_crops;return Number.isInteger(t)?t.toString():e.num_crops.toFixed(2)},compare:(e,t)=>e.num_crops-t.num_crops},{name:"Profit",cellText:e=>e.profit.toFixed(2),compare:(e,t)=>e.profit-t.profit},{name:"Daily Profit",cellText:e=>Number.isFinite(e.daily_profit)?e.daily_profit.toFixed(2):"-",compare:(e,t)=>e.daily_profit-t.daily_profit}];class i{constructor(e,t){this.data=t,this.row=e;for(let e of a){let t=e.cellText(this.data);this.row.insertCell().appendChild(document.createTextNode(t))}}}function l(e){switch(e){case"ascending":return"descending";case"descending":return"ascending"}}class _{constructor(e){this.table=e,this.rows=[],this.current_sort=null,this.thead=this.table.createTHead(),this.tbody=this.table.createTBody();let t=this.thead.insertRow();for(let[e,o]of a.entries()){let r=t.insertCell();r.appendChild(document.createTextNode(o.name)),r.addEventListener("click",(t=>{let o;o=null!==this.current_sort&&this.current_sort[0]===e?l(this.current_sort[1]):"ascending",this.current_sort=[e,o];let r=this.thead.querySelectorAll("td");for(let e of r)e.removeAttribute("aria-sort");r[e].setAttribute("aria-sort",o),this.sortRows()}))}}repopulateTable(t){this.tbody.replaceChildren(),this.rows=[];for(let o of e){let e=n(o,t);if("out-of-season"==e)continue;let r=this.tbody.insertRow();this.rows.push(new i(r,e))}this.sortRows()}sortRows(){let e,t;null===this.current_sort?(e=0,t="ascending"):[e,t]=this.current_sort;let o=a[e];this.rows.sort(((e,r)=>{let s=o.compare(e.data,r.data);return"ascending"===t?s:-s}));for(let e of this.rows)this.tbody.appendChild(e.row)}}function d(){console.log("Initializing!");let e=document.getElementById("crop-table");if(!(e instanceof HTMLTableElement))throw new Error("crop-table should be a <table>");let o=document.getElementById("input-panel"),r=document.querySelector("#season"),s=document.querySelector("#day"),n=document.querySelector("#enable-multiseason"),a=document.querySelector("#enable-quality"),i=document.querySelector("#farmer-level"),l=new _(e);function d(){let e,o=function(e){let t=e/10*.2+(e+2)/12*0+.01,o=t/2;o=0;let r=1*t,s=(1-r)*Math.min(2*t,.75);return{normal:1-r-s,silver:s,gold:r,iridium:0}}(i.valueAsNumber),_=o.normal+1.25*o.silver+1.5*o.gold+2*o.iridium,d={season:t.fromString(r.value),start_day:s.valueAsNumber,multiseason_enabled:n.checked,quality_probabilities:a.checked?o:null};for(e in l.repopulateTable(d),document.documentElement.className=r.value.toLowerCase(),o){let t=document.getElementById(`percent-${e}`),r=100*o[e];t.textContent=`${r.toFixed(0)}%`}document.getElementById("average-quality").textContent=_.toFixed(2)}d(),o.addEventListener("change",(e=>{d()}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JvcHMuanMiLCJtYXBwaW5ncyI6InkwSEFVQSxJQUFLQSxHQUFMLFNBQUtBLEdBQ0QsdUJBQVEsdUJBQVEsbUJBQU0sc0JBQ3pCLENBRkQsQ0FBS0EsSUFBQUEsRUFBTSxLQUlYLFNBQVVBLEdBQ1UsRUFBQUMsV0FBaEIsU0FBMkJDLEdBQ3ZCLE9BQVFBLEVBQUVDLGVBQ04sSUFBSyxTQUNELE9BQU9ILEVBQU9JLE9BQ2xCLElBQUssU0FDRCxPQUFPSixFQUFPSyxPQUNsQixJQUFLLE9BQ0QsT0FBT0wsRUFBT00sS0FDbEIsSUFBSyxTQUNELE9BQU9OLEVBQU9PLE9BQ2xCLFFBQ0ksTUFBTSxJQUFJQyxNQUFNLGtCQUFrQk4sS0FFOUMsQ0FDSCxDQWZELENBQVVGLElBQUFBLEVBQU0sS0FpQ2hCLE1BQU1TLEVBQW9CLEtBQ3BCQyxFQUFrQixJQUNsQkMsRUFBcUIsRUFzQzNCLFNBQVNDLEVBQVVDLEVBQXNCQyxHLFVBRXJDLElBQUlDLEVBQW9CLEdBQ3BCQyxFQUE4QixRQUFoQixFQUFBSCxFQUFLSSxtQkFBVyxRQUFJLEVBQ3RDLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJRixFQUFhRSxJQUM3QkgsRUFBUUksS0FBS25CLEVBQU9DLFdBQVdZLEVBQUtPLFFBQVFDLFVBQVlILEdBSTVELElBQUtILEVBQVFPLFNBQVNSLEVBQVNNLFFBQzNCLE1BQU8sZ0JBSVgsSUFHSUcsRUFBWSxJQUhHVCxFQUFTVSxvQkFDdEJULEVBQVFVLE9BQVNWLEVBQVFXLFFBQVFaLEVBQVNNLFFBQzFDLEdBQzhCTixFQUFTYSxVQUd6Q0MsRUFBZSxFQUNmQyxFQUFjLEVBQ2xCLEdBQUlOLEdBQWFWLEVBQUtpQixlQUNsQkYsR0FBZ0IsRUFDaEJDLEdBQWVoQixFQUFLaUIsYUFDaEJqQixFQUFLa0IsaUJBQWlCLENBQ3RCLElBQUlDLEVBQWlCQyxLQUFLQyxPQUFPWCxFQUFZVixFQUFLaUIsY0FBZ0JqQixFQUFLa0IsaUJBQ3ZFSCxHQUFnQkksRUFDaEJILEdBQWVHLEVBQWlCbkIsRUFBS2tCLGVBQ3pDLENBSUosSUFDSUksRUFEQUMsRUFBYXZCLEVBQUt3QixXQUV0QixHQUFJdkIsRUFBU3dCLHNCQUF1QixDQUNoQyxJQUFJQyxFQUFJekIsRUFBU3dCLHNCQUVqQkgsRUFBZ0IsQ0FDWixDQUFDLEVBQUtJLEVBQUVDLFFBQ1IsQ0FBQy9CLEVBQW1COEIsRUFBRUUsUUFDdEIsQ0FBQy9CLEVBQWlCNkIsRUFBRUcsTUFDcEIsQ0FBQy9CLEVBQW9CNEIsRUFBRUksVUFHdEJDLEtBQUksRUFBRUMsRUFBWUMsS0FBT2IsS0FBS2MsTUFBTUYsRUFBYVQsR0FBY1UsSUFDL0RFLFFBQU8sQ0FBQ0MsRUFBR0MsSUFBTUQsRUFBSUMsR0FDOUIsTUFDSWYsRUFBZ0JDLEVBTXBCLElBQUllLEdBQW1DLFFBQVYsRUFBQXRDLEVBQUt1QyxhQUFLLFFBQUksSUFBK0IsUUFBekIsRUFBQXZDLEVBQUt3Qyw0QkFBb0IsUUFBSSxHQUFLLElBSS9FQyxHQUhzQm5CLEdBQWlCZ0IsRUFBd0IsR0FBS2YsR0FHckNSLEVBQWVmLEVBQUswQyxVQUd2RCxNQUFPLENBQ0hDLFdBQVkzQyxFQUNaZ0IsY0FDQUQsZUFDQTZCLFVBQVdOLEVBQXdCdkIsRUFDbkMwQixTQUNBSSxhQVJlSixFQUFTekIsRUFVaEMsQ0FXQSxNQUFNOEIsRUFBb0IsQ0FDdEIsQ0FDSUMsS0FBTSxPQUNOQyxTQUFXaEQsR0FBbUJBLEVBQUsyQyxXQUFXSSxLQUM5Q0UsUUFBUyxDQUFDYixFQUFhQyxJQUFnQkQsRUFBRU8sV0FBV0ksS0FBS0csY0FBY2IsRUFBRU0sV0FBV0ksT0FFeEYsQ0FDSUEsS0FBTSxZQUNOQyxTQUFXaEQsR0FBbUJBLEVBQUsyQyxXQUFXRCxVQUFVUyxXQUN4REYsUUFBUyxDQUFDYixFQUFhQyxJQUFnQkQsRUFBRU8sV0FBV0QsVUFBWUwsRUFBRU0sV0FBV0QsV0FFakYsQ0FDSUssS0FBTSxhQUNOQyxTQUFXaEQsR0FBbUJBLEVBQUsyQyxXQUFXbkIsV0FBVzJCLFdBQ3pERixRQUFTLENBQUNiLEVBQWFDLElBQWdCRCxFQUFFTyxXQUFXbkIsV0FBYWEsRUFBRU0sV0FBV25CLFlBRWxGLENBQ0l1QixLQUFNLGVBQ05DLFNBQVdoRCxHQUFtQkEsRUFBSzJDLFdBQVcxQixhQUFha0MsV0FDM0RGLFFBQVMsQ0FBQ2IsRUFBYUMsSUFBZ0JELEVBQUVPLFdBQVcxQixhQUFlb0IsRUFBRU0sV0FBVzFCLGNBRXBGLENBQ0k4QixLQUFNLGtCQUNOQyxTQUFXaEQsSUFBa0IsUUFBQyxPQUEyQyxRQUEzQyxFQUErQixRQUEvQixFQUFBQSxFQUFLMkMsV0FBV3pCLHVCQUFlLGVBQUVpQyxrQkFBVSxRQUFJLEdBQUcsRUFDaEZGLFFBQVMsQ0FBQ2IsRUFBYUMsU0FDa0JlLElBQWpDZixFQUFFTSxXQUFXekIsaUJBQ0wsT0FDZ0NrQyxJQUFqQ2hCLEVBQUVPLFdBQVd6QixnQkFDYixFQUVKa0IsRUFBRU8sV0FBV3pCLGdCQUFrQm1CLEVBQUVNLFdBQVd6QixpQkFHM0QsQ0FDSTZCLEtBQU0sUUFDTkMsU0FBV2hELEksTUFDUCxJQUFJcUQsRUFBaUMsUUFBckIsRUFBQXJELEVBQUsyQyxXQUFXSixhQUFLLFFBQUksRUFDekMsT0FBSXZDLEVBQUsyQyxXQUFXSCxxQkFDVCxHQUFHYSxPQUFlckQsRUFBSzJDLFdBQVdILHdCQUVsQ2EsRUFBVUYsVUFDckIsRUFFSkYsUUFBUyxDQUFDYixFQUFhQyxLLFlBSW5CLE9BRitCLFFBQWxCLEVBQUFELEVBQUVPLFdBQVdKLGFBQUssUUFBSSxJQUF1QyxRQUFqQyxFQUFBSCxFQUFFTyxXQUFXSCw0QkFBb0IsUUFBSSxHQUFLLE1BQ3BELFFBQWxCLEVBQUFILEVBQUVNLFdBQVdKLGFBQUssUUFBSSxJQUF1QyxRQUFqQyxFQUFBRixFQUFFTSxXQUFXSCw0QkFBb0IsUUFBSSxHQUFLLElBQy9ELEdBRzVCLENBQ0lPLEtBQU0sY0FDTkMsU0FBV2hELEdBQW1CQSxFQUFLZ0IsWUFBWW1DLFdBQy9DRixRQUFTLENBQUNiLEVBQWFDLElBQWdCRCxFQUFFcEIsWUFBY3FCLEVBQUVyQixhQUU3RCxDQUNJK0IsS0FBTSxlQUNOQyxTQUFXaEQsR0FBbUJBLEVBQUtlLGFBQWFvQyxXQUNoREYsUUFBUyxDQUFDYixFQUFhQyxJQUFnQkQsRUFBRVEsVUFBWVAsRUFBRU8sV0FFM0QsQ0FDSUcsS0FBTSxZQUNOQyxTQUFXaEQsSUFDUCxJQUFJNEMsRUFBWTVDLEVBQUs0QyxVQUNyQixPQUFJVSxPQUFPQyxVQUFVWCxHQUNWQSxFQUFVTyxXQUVkbkQsRUFBSzRDLFVBQVVZLFFBQVEsRUFBRSxFQUVwQ1AsUUFBUyxDQUFDYixFQUFhQyxJQUFnQkQsRUFBRVEsVUFBWVAsRUFBRU8sV0FFM0QsQ0FDSUcsS0FBTSxTQUNOQyxTQUFXaEQsR0FBbUJBLEVBQUt5QyxPQUFPZSxRQUFRLEdBQ2xEUCxRQUFTLENBQUNiLEVBQWFDLElBQWdCRCxFQUFFSyxPQUFTSixFQUFFSSxRQUV4RCxDQUNJTSxLQUFNLGVBQ05DLFNBQVdoRCxHQUNIc0QsT0FBT0csU0FBU3pELEVBQUs2QyxjQUNkN0MsRUFBSzZDLGFBQWFXLFFBQVEsR0FFOUIsSUFFWFAsUUFBUyxDQUFDYixFQUFhQyxJQUFnQkQsRUFBRVMsYUFBZVIsRUFBRVEsZUFJbEUsTUFBTWEsRUFJRixXQUFBQyxDQUFZQyxFQUEwQkMsR0FDbENDLEtBQUtELEtBQU9BLEVBQ1pDLEtBQUtGLElBQU1BLEVBR1gsSUFBSyxJQUFJRyxLQUFPakIsRUFBUyxDQUNyQixJQUFJa0IsRUFBUUQsRUFBSWYsU0FBU2MsS0FBS0QsTUFDOUJDLEtBQUtGLElBQUlLLGFBQWFDLFlBQVlDLFNBQVNDLGVBQWVKLEdBQzlELENBQ0osRUFJSixTQUFTSyxFQUFjQyxHQUNuQixPQUFRQSxHQUNKLElBQUssWUFDRCxNQUFPLGFBQ1gsSUFBSyxhQUNELE1BQU8sWUFFbkIsQ0FFQSxNQUFNQyxFQU9GLFdBQUFaLENBQVlhLEdBQ1JWLEtBQUtVLE1BQVFBLEVBQ2JWLEtBQUtXLEtBQU8sR0FDWlgsS0FBS1ksYUFBZSxLQUdwQlosS0FBS2EsTUFBUWIsS0FBS1UsTUFBTUksY0FDeEJkLEtBQUtlLE1BQVFmLEtBQUtVLE1BQU1NLGNBR3hCLElBQUlsQixFQUFNRSxLQUFLYSxNQUFNSSxZQUNyQixJQUFLLElBQUtDLEVBQUtqQixLQUFRakIsRUFBUW1DLFVBQVcsQ0FDdEMsSUFBSUMsRUFBT3RCLEVBQUlLLGFBQ2ZpQixFQUFLaEIsWUFBWUMsU0FBU0MsZUFBZUwsRUFBSWhCLE9BQzdDbUMsRUFBS0MsaUJBQWlCLFNBQVVDLElBRTVCLElBQUlDLEVBRUFBLEVBRHNCLE9BQXRCdkIsS0FBS1ksY0FBeUJaLEtBQUtZLGFBQWEsS0FBT00sRUFDakRYLEVBQWNQLEtBQUtZLGFBQWEsSUFFaEMsWUFFVlosS0FBS1ksYUFBZSxDQUFDTSxFQUFLSyxHQUcxQixJQUFJQyxFQUFVeEIsS0FBS2EsTUFBTVksaUJBQWlCLE1BQzFDLElBQUssSUFBSUMsS0FBVUYsRUFDZkUsRUFBT0MsZ0JBQWdCLGFBRTNCSCxFQUFRTixHQUFLVSxhQUFhLFlBQWFMLEdBR3ZDdkIsS0FBSzZCLFVBQVUsR0FFdkIsQ0FLSixDQUdPLGVBQUFDLENBQWdCM0YsR0FFbkI2RCxLQUFLZSxNQUFNZ0Isa0JBQ1gvQixLQUFLVyxLQUFPLEdBQ1osSUFBSyxJQUFJcUIsS0FBTyxFQUFrQixDQUU5QixJQUFJakMsRUFBTzlELEVBQVUrRixFQUFLN0YsR0FDMUIsR0FBWSxpQkFBUjRELEVBQ0EsU0FFSixJQUFJRCxFQUFNRSxLQUFLZSxNQUFNRSxZQUNyQmpCLEtBQUtXLEtBQUtuRSxLQUFLLElBQUlvRCxFQUFRRSxFQUFLQyxHQUNwQyxDQUdBQyxLQUFLNkIsVUFDVCxDQUVRLFFBQUFBLEdBRUosSUFBSVgsRUFDQUssRUFDc0IsT0FBdEJ2QixLQUFLWSxjQUNMTSxFQUFNLEVBQ05LLEVBQU0sY0FFTEwsRUFBS0ssR0FBT3ZCLEtBQUtZLGFBS3RCLElBQUlYLEVBQU1qQixFQUFRa0MsR0FDbEJsQixLQUFLVyxLQUFLc0IsTUFBSyxDQUFDM0QsRUFBR0MsS0FDZixJQUFJWSxFQUFVYyxFQUFJZCxRQUFRYixFQUFFeUIsS0FBTXhCLEVBQUV3QixNQUNwQyxNQUFlLGNBQVJ3QixFQUFzQnBDLEdBQVdBLENBQU8sSUFJbkQsSUFBSyxJQUFJVyxLQUFPRSxLQUFLVyxLQUNqQlgsS0FBS2UsTUFBTVgsWUFBWU4sRUFBSUEsSUFFbkMsRUFHSixTQUFTb0MsSUFDTEMsUUFBUUMsSUFBSSxpQkFHWixJQUFJMUIsRUFBUUwsU0FBU2dDLGVBQWUsY0FDcEMsS0FBTTNCLGFBQWlCNEIsa0JBQ25CLE1BQU0sSUFBSXpHLE1BQU0sa0NBR3BCLElBQUkwRyxFQUFjbEMsU0FBU2dDLGVBQWUsZUFDdENHLEVBQWVuQyxTQUFTb0MsY0FBZ0MsV0FDeERDLEVBQW9CckMsU0FBU29DLGNBQWdDLFFBQzdERSxFQUFxQnRDLFNBQVNvQyxjQUFnQyx1QkFDOURHLEVBQWlCdkMsU0FBU29DLGNBQWdDLG1CQUMxREksRUFBc0J4QyxTQUFTb0MsY0FBZ0MsaUJBRy9ESyxFQUFrQixJQUFJckMsRUFBVUMsR0FHcEMsU0FBU3FDLElBRUwsSUFpQklDLEVBakJBQyxFQXpWWixTQUF3QkMsR0FFcEIsSUFJSUMsRUFBcUJELEVBQWdCLEdBQXZCLElBQTBEQSxFQUFnQixHQUFPLEdBQWxELEVBQTBELElBRXZHRSxFQUFpQkQsRUFBYyxFQUduQ0MsRUFBaUIsRUFNakIsSUFFSXJGLEVBQU8sRUFBZ0JvRixFQUd2QnJGLEdBQVUsRUFBY0MsR0FmUlQsS0FBSytGLElBQUksRUFBSUYsRUFBYSxLQW1COUMsTUFBTyxDQUFFdEYsT0FGSSxFQUFjRSxFQUFPRCxFQUVqQkEsU0FBUUMsT0FBTUMsUUFmZCxFQWdCckIsQ0E4VHNCc0YsQ0FBZVQsRUFBb0JVLGVBQzdDQyxFQUFpQlAsRUFBUXBGLE9BQTBCLEtBQWpCb0YsRUFBUW5GLE9BQStCLElBQWZtRixFQUFRbEYsS0FBK0IsRUFBbEJrRixFQUFRakYsUUFHdkY3QixFQUFxQixDQUNyQk0sT0FBUXBCLEVBQU9DLFdBQVdrSCxFQUFhdEMsT0FDdkNsRCxVQUFXMEYsRUFBa0JhLGNBQzdCMUcsb0JBQXFCOEYsRUFBbUJjLFFBQ3hDOUYsc0JBQXVCaUYsRUFBZWEsUUFBVVIsRUFBVSxNQVU5RCxJQUFLRCxLQU5MRixFQUFnQmhCLGdCQUFnQjNGLEdBQ2hDa0UsU0FBU3FELGdCQUFnQkMsVUFBWW5CLEVBQWF0QyxNQUFNMEQsY0FLNUNYLEVBQVMsQ0FDakIsSUFBSTdCLEVBQU9mLFNBQVNnQyxlQUFlLFdBQVdXLEtBQzFDYSxFQUFVLElBQU1aLEVBQVFELEdBQzVCNUIsRUFBSzBDLFlBQWMsR0FBR0QsRUFBUW5FLFFBQVEsS0FDMUMsQ0FDQVcsU0FBU2dDLGVBQWUsbUJBQW9CeUIsWUFBY04sRUFBZTlELFFBQVEsRUFDckYsQ0FHQXFELElBR0FSLEVBQVlsQixpQkFBaUIsVUFBV0MsSUFDcEN5QixHQUFzQixHQUU5QixDQUs0QixZQUF4QjFDLFNBQVMwRCxXQUVUMUQsU0FBU2dCLGlCQUFpQixtQkFBb0JhLEdBRzlDQSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2Nyb3BzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuLy8gc2hvdWxkIGkgcHVsbCB0aGlzIGZyb20gYSBKU09OIGxpa2UgaSdtIGRvaW5nIG5vdz8gb3Igc2hvdWxkIGkganVzdFxyXG4vLyBoYXJkLWNvZGUgaXQgaW5saW5lIChtaWdodCBiZSBtb3JlIHJlYWRhYmxlKVxyXG5pbXBvcnQgQ1JPUF9ERUZJTklUSU9OUyBmcm9tIFwiLi9jcm9wcy5qc29uXCI7XHJcblxyXG4vKiA9PT09PT09PSBDQUxDVUxBVElPTiA9PT09PT09PSAqL1xyXG5cclxudHlwZSBDcm9wRGVmaW5pdGlvbiA9IHR5cGVvZiBDUk9QX0RFRklOSVRJT05TW251bWJlcl07XHJcblxyXG5lbnVtIFNlYXNvbiB7XHJcbiAgICBTUFJJTkcsIFNVTU1FUiwgRkFMTCwgV0lOVEVSXHJcbn1cclxuXHJcbm5hbWVzcGFjZSBTZWFzb24ge1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGZyb21TdHJpbmcoczogc3RyaW5nKTogU2Vhc29uIHtcclxuICAgICAgICBzd2l0Y2ggKHMudG9VcHBlckNhc2UoKSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiU1BSSU5HXCI6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gU2Vhc29uLlNQUklORztcclxuICAgICAgICAgICAgY2FzZSBcIlNVTU1FUlwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFNlYXNvbi5TVU1NRVI7XHJcbiAgICAgICAgICAgIGNhc2UgXCJGQUxMXCI6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gU2Vhc29uLkZBTEw7XHJcbiAgICAgICAgICAgIGNhc2UgXCJXSU5URVJcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBTZWFzb24uV0lOVEVSO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHNlYXNvbiAke3N9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG50eXBlIENyb3BEYXRhID0ge1xyXG4gICAgZGVmaW5pdGlvbjogQ3JvcERlZmluaXRpb24sXHJcbiAgICB1c2VmdWxfZGF5czogbnVtYmVyLFxyXG4gICAgbnVtX2hhcnZlc3RzOiBudW1iZXIsXHJcbiAgICBudW1fY3JvcHM6IG51bWJlcixcclxuICAgIHByb2ZpdDogbnVtYmVyLFxyXG4gICAgZGFpbHlfcHJvZml0OiBudW1iZXIsXHJcbn07XHJcblxyXG50eXBlIFF1YWxpdHlQcm9iYWJpbGl0aWVzID0ge1xyXG4gICAgbm9ybWFsOiBudW1iZXIsXHJcbiAgICBzaWx2ZXI6IG51bWJlcixcclxuICAgIGdvbGQ6IG51bWJlcixcclxuICAgIGlyaWRpdW06IG51bWJlcixcclxufTtcclxuXHJcbmNvbnN0IFNJTFZFUl9NVUxUSVBMSUVSID0gMS4yNTtcclxuY29uc3QgR09MRF9NVUxUSVBMSUVSID0gMS41O1xyXG5jb25zdCBJUklESVVNX01VTFRJUExJRVIgPSAyLjA7XHJcblxyXG5mdW5jdGlvbiBjb21wdXRlUXVhbGl0eShmYXJtaW5nX2xldmVsOiBudW1iZXIpOiBRdWFsaXR5UHJvYmFiaWxpdGllcyB7XHJcbiAgICAvLyBodHRwczovL3N0YXJkZXd2YWxsZXl3aWtpLmNvbS9GYXJtaW5nI0NvbXBsZXRlX0Zvcm11bGFfMlxyXG4gICAgbGV0IGZlcnRpbGl6ZXJfbGV2ZWwgPSAwO1xyXG5cclxuICAgIC8vIFF1YWxpdHkgZm9yIGEgY3JvcCBpcyBkZXRlcm1pbmVkIGJ5IGEgc2VyaWVzIG9mIHdlaWdodGVkIGNvaW4gZmxpcHMuXHJcbiAgICAvLyBUaGUgcHJvYmFiaWxpdGllcyBmb3IgdGhlIGNvaW5zIGFyZSBjb21wdXRlZCBoZXJlLlxyXG4gICAgbGV0IHBfZ29sZF9jb2luID0gMC4yICogKGZhcm1pbmdfbGV2ZWwgLyAxMC4wKSArIDAuMiAqIGZlcnRpbGl6ZXJfbGV2ZWwgKiAoKGZhcm1pbmdfbGV2ZWwgKyAyLjApIC8gMTIuMCkgKyAwLjAxO1xyXG4gICAgbGV0IHBfc2lsdmVyX2NvaW4gPSBNYXRoLm1pbigyICogcF9nb2xkX2NvaW4sIDAuNzUpO1xyXG4gICAgbGV0IHBfaXJpZGl1bV9jb2luID0gcF9nb2xkX2NvaW4gLyAyO1xyXG5cclxuICAgIC8vIFRPRE86IHRoaXMgaXMgb25seSBlbmFibGVkIGF0IGNlcnRhaW4gZmVydGlsaXplciBsZXZlbHNcclxuICAgIHBfaXJpZGl1bV9jb2luID0gMDtcclxuXHJcbiAgICAvLyBIb3dldmVyLCB0aGVzZSBjb2lucyBhcmUgZmxpcHBlZCBvbmUgYXQgYSB0aW1lLCBzbyB3ZSBoYXZlIHNsaWdodGx5IG1vcmVcclxuICAgIC8vIHdvcmsgdG8gZG8gdG8gZmluZCBvdXQgdGhlIGZpbmFsIHByb2JhYmlsaXRpZXMuXHJcblxyXG4gICAgLy8gQ2hhbmNlIG9mIGlyaWRpdW0gaXMganVzdCB0aGUgbG9jYWwgY2hhbmNlIG9mIGlyaWRpdW0uXHJcbiAgICBsZXQgaXJpZGl1bSA9IHBfaXJpZGl1bV9jb2luO1xyXG4gICAgLy8gVG8gZ2V0IGdvbGQsIGRvbid0IGJlIGlyaWRpdW0sIGFuZCBwYXNzIHRoZSBnb2xkIGNvaW4gZmxpcC5cclxuICAgIGxldCBnb2xkID0gKDEgLSBpcmlkaXVtKSAqIHBfZ29sZF9jb2luO1xyXG4gICAgLy8gU2ltaWxhcmx5LCBmb3Igc2lsdmVyLCBkb24ndCBiZSBpcmlkdW0gb3IgZ29sZCwgYW5kIHBhc3MgdGhlXHJcbiAgICAvLyBzaWx2ZXIgY29pbiBmbGlwLlxyXG4gICAgbGV0IHNpbHZlciA9ICgxIC0gaXJpZGl1bSAtIGdvbGQpICogcF9zaWx2ZXJfY29pbjtcclxuICAgIC8vIEJhc2UgcXVhbGl0eSBpcyBldmVyeXRoaW5nIGVsc2UuXHJcbiAgICBsZXQgbm9ybWFsID0gMSAtIGlyaWRpdW0gLSBnb2xkIC0gc2lsdmVyO1xyXG5cclxuICAgIHJldHVybiB7IG5vcm1hbCwgc2lsdmVyLCBnb2xkLCBpcmlkaXVtIH07XHJcbn1cclxuXHJcbnR5cGUgU2V0dGluZ3MgPSB7XHJcbiAgICBzZWFzb246IFNlYXNvbixcclxuICAgIHN0YXJ0X2RheTogbnVtYmVyLFxyXG4gICAgbXVsdGlzZWFzb25fZW5hYmxlZDogYm9vbGVhbixcclxuICAgIHF1YWxpdHlfcHJvYmFiaWxpdGllczogUXVhbGl0eVByb2JhYmlsaXRpZXMgfCBudWxsLFxyXG59O1xyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlKGNyb3A6IENyb3BEZWZpbml0aW9uLCBzZXR0aW5nczogU2V0dGluZ3MpOiBDcm9wRGF0YSB8IFwib3V0LW9mLXNlYXNvblwiIHtcclxuICAgIC8vIFdoZW4gaXMgdGhpcyBjcm9wIGluLXNlYXNvbj9cclxuICAgIGxldCBzZWFzb25zOiBTZWFzb25bXSA9IFtdO1xyXG4gICAgbGV0IG51bV9zZWFzb25zID0gY3JvcC5tdWx0aXNlYXNvbiA/PyAxO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1fc2Vhc29uczsgaSsrKSB7XHJcbiAgICAgICAgc2Vhc29ucy5wdXNoKFNlYXNvbi5mcm9tU3RyaW5nKGNyb3Auc2Vhc29uKS52YWx1ZU9mKCkgKyBpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBCYWlsIG91dCBpZiB3ZSdyZSBvdXQgb2Ygc2Vhc29uXHJcbiAgICBpZiAoIXNlYXNvbnMuaW5jbHVkZXMoc2V0dGluZ3Muc2Vhc29uKSkge1xyXG4gICAgICAgIHJldHVybiBcIm91dC1vZi1zZWFzb25cIjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBIb3cgbWFueSBkYXlzIGRvIHdlIGhhdmUgbGVmdD9cclxuICAgIGxldCBzZWFzb25zX2xlZnQgPSBzZXR0aW5ncy5tdWx0aXNlYXNvbl9lbmFibGVkXHJcbiAgICAgICAgPyBzZWFzb25zLmxlbmd0aCAtIHNlYXNvbnMuaW5kZXhPZihzZXR0aW5ncy5zZWFzb24pXHJcbiAgICAgICAgOiAxO1xyXG4gICAgbGV0IGRheXNfbGVmdCA9IDI4ICogc2Vhc29uc19sZWZ0IC0gc2V0dGluZ3Muc3RhcnRfZGF5O1xyXG5cclxuICAgIC8vIEluIHRoZSBudW1iZXIgb2YgZGF5cyByZW1haW5pbmcsIGhvdyBtYW55IGhhcnZlc3RzIGRvIHdlIGdldD9cclxuICAgIGxldCBudW1faGFydmVzdHMgPSAwO1xyXG4gICAgbGV0IHVzZWZ1bF9kYXlzID0gMDtcclxuICAgIGlmIChkYXlzX2xlZnQgPj0gY3JvcC5kYXlzX3RvX2dyb3cpIHtcclxuICAgICAgICBudW1faGFydmVzdHMgKz0gMTtcclxuICAgICAgICB1c2VmdWxfZGF5cyArPSBjcm9wLmRheXNfdG9fZ3JvdztcclxuICAgICAgICBpZiAoY3JvcC5yZWdyb3d0aF9wZXJpb2QpIHtcclxuICAgICAgICAgICAgbGV0IGV4dHJhX2hhcnZlc3RzID0gTWF0aC5mbG9vcigoZGF5c19sZWZ0IC0gY3JvcC5kYXlzX3RvX2dyb3cpIC8gY3JvcC5yZWdyb3d0aF9wZXJpb2QpO1xyXG4gICAgICAgICAgICBudW1faGFydmVzdHMgKz0gZXh0cmFfaGFydmVzdHM7XHJcbiAgICAgICAgICAgIHVzZWZ1bF9kYXlzICs9IGV4dHJhX2hhcnZlc3RzICogY3JvcC5yZWdyb3d0aF9wZXJpb2Q7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEhvdyBtdWNoIGlzIGEgY3JvcCB3b3J0aCwgb24gYXZlcmFnZT9cclxuICAgIGxldCBiYXNlX3ByaWNlID0gY3JvcC5zZWxsX3ByaWNlO1xyXG4gICAgbGV0IHF1YWxpdHlfcHJpY2U7XHJcbiAgICBpZiAoc2V0dGluZ3MucXVhbGl0eV9wcm9iYWJpbGl0aWVzKSB7XHJcbiAgICAgICAgbGV0IHEgPSBzZXR0aW5ncy5xdWFsaXR5X3Byb2JhYmlsaXRpZXM7XHJcbiAgICAgICAgLy8gemlwIHRvZ2V0aGVyIHByaWNlcyBhbmQgcHJvYmFiaWxpdGllc1xyXG4gICAgICAgIHF1YWxpdHlfcHJpY2UgPSBbXHJcbiAgICAgICAgICAgIFsxLjAsIHEubm9ybWFsXSxcclxuICAgICAgICAgICAgW1NJTFZFUl9NVUxUSVBMSUVSLCBxLnNpbHZlcl0sXHJcbiAgICAgICAgICAgIFtHT0xEX01VTFRJUExJRVIsIHEuZ29sZF0sXHJcbiAgICAgICAgICAgIFtJUklESVVNX01VTFRJUExJRVIsIHEuaXJpZGl1bV0sXHJcbiAgICAgICAgXVxyXG4gICAgICAgICAgICAvLyBwcmljZXMgYXJlIHJvdW5kZWQgZG93biFcclxuICAgICAgICAgICAgLm1hcCgoW211bHRpcGxpZXIsIHBdKSA9PiBNYXRoLnRydW5jKG11bHRpcGxpZXIgKiBiYXNlX3ByaWNlKSAqIHApXHJcbiAgICAgICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcXVhbGl0eV9wcmljZSA9IGJhc2VfcHJpY2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV2UgY2FuIHNvbWV0aW1lcyBnZXQgbXVsdGlwbGUgY3JvcHMgcGVyIGhhcnZlc3QsIGJ1dCBhbGwgdGhlIGV4dHJhIGNyb3BzXHJcbiAgICAvLyB3aWxsIGJlIHJlZ3VsYXIgcXVhbGl0eS5cclxuICAgIC8vIFRPRE86IGlzIHRoaXMgdHJ1ZT8gaSBzZWUgY29uZmxpY3Rpbmcgc291cmNlcyBvbmxpbmVcclxuICAgIGxldCBudW1fY3JvcHNfcGVyX2hhcnZlc3QgPSAoY3JvcC55aWVsZCA/PyAxKSArIChjcm9wLnBlcmNlbnRfY2hhbmNlX2V4dHJhID8/IDApIC8gMTAwLjA7XHJcbiAgICBsZXQgcmV2ZW51ZV9wZXJfaGFydmVzdCA9IHF1YWxpdHlfcHJpY2UgKyAobnVtX2Nyb3BzX3Blcl9oYXJ2ZXN0IC0gMSkgKiBiYXNlX3ByaWNlO1xyXG5cclxuICAgIC8vIE9rYXksIGxldCdzIGNhbGN1bGF0ZSBldmVyeXRoaW5nIVxyXG4gICAgbGV0IHByb2ZpdCA9IHJldmVudWVfcGVyX2hhcnZlc3QgKiBudW1faGFydmVzdHMgLSBjcm9wLnNlZWRfY29zdDtcclxuICAgIGxldCBkYWlseV9wcm9maXQgPSBwcm9maXQgLyB1c2VmdWxfZGF5cztcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGRlZmluaXRpb246IGNyb3AsXHJcbiAgICAgICAgdXNlZnVsX2RheXMsXHJcbiAgICAgICAgbnVtX2hhcnZlc3RzLFxyXG4gICAgICAgIG51bV9jcm9wczogbnVtX2Nyb3BzX3Blcl9oYXJ2ZXN0ICogbnVtX2hhcnZlc3RzLFxyXG4gICAgICAgIHByb2ZpdCxcclxuICAgICAgICBkYWlseV9wcm9maXQsXHJcbiAgICB9O1xyXG59XHJcblxyXG4vKiA9PT09PT09PSBHVUkgPT09PT09PT0gKi9cclxuXHJcbi8vIERlZmluZXMgdGhlIHNldCBvZiBjb2x1bW5zIGZvciB0aGUgd2hvbGUgdGFibGUuXHJcbnR5cGUgQ29sdW1uID0ge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gc3RyaW5nO1xyXG4gICAgY29tcGFyZTogKGE6IENyb3BEYXRhLCBiOiBDcm9wRGF0YSkgPT4gbnVtYmVyO1xyXG59O1xyXG5cclxuY29uc3QgQ09MVU1OUzogQ29sdW1uW10gPSBbXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJOYW1lXCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gY3JvcC5kZWZpbml0aW9uLm5hbWUsXHJcbiAgICAgICAgY29tcGFyZTogKGE6IENyb3BEYXRhLCBiOiBDcm9wRGF0YSkgPT4gYS5kZWZpbml0aW9uLm5hbWUubG9jYWxlQ29tcGFyZShiLmRlZmluaXRpb24ubmFtZSksXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiU2VlZCBDb3N0XCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gY3JvcC5kZWZpbml0aW9uLnNlZWRfY29zdC50b1N0cmluZygpLFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEuZGVmaW5pdGlvbi5zZWVkX2Nvc3QgLSBiLmRlZmluaXRpb24uc2VlZF9jb3N0LFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIlNlbGwgUHJpY2VcIixcclxuICAgICAgICBjZWxsVGV4dDogKGNyb3A6IENyb3BEYXRhKSA9PiBjcm9wLmRlZmluaXRpb24uc2VsbF9wcmljZS50b1N0cmluZygpLFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEuZGVmaW5pdGlvbi5zZWxsX3ByaWNlIC0gYi5kZWZpbml0aW9uLnNlbGxfcHJpY2UsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiRGF5cyB0byBHcm93XCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gY3JvcC5kZWZpbml0aW9uLmRheXNfdG9fZ3Jvdy50b1N0cmluZygpLFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEuZGVmaW5pdGlvbi5kYXlzX3RvX2dyb3cgLSBiLmRlZmluaXRpb24uZGF5c190b19ncm93LFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIlJlZ3Jvd3RoIFBlcmlvZFwiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IGNyb3AuZGVmaW5pdGlvbi5yZWdyb3d0aF9wZXJpb2Q/LnRvU3RyaW5nKCkgPz8gXCItXCIsXHJcbiAgICAgICAgY29tcGFyZTogKGE6IENyb3BEYXRhLCBiOiBDcm9wRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYi5kZWZpbml0aW9uLnJlZ3Jvd3RoX3BlcmlvZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5kZWZpbml0aW9uLnJlZ3Jvd3RoX3BlcmlvZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYS5kZWZpbml0aW9uLnJlZ3Jvd3RoX3BlcmlvZCAtIGIuZGVmaW5pdGlvbi5yZWdyb3d0aF9wZXJpb2Q7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIllpZWxkXCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgeWllbGRfbnVtID0gY3JvcC5kZWZpbml0aW9uLnlpZWxkID8/IDE7XHJcbiAgICAgICAgICAgIGlmIChjcm9wLmRlZmluaXRpb24ucGVyY2VudF9jaGFuY2VfZXh0cmEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgJHt5aWVsZF9udW19ICsgJHtjcm9wLmRlZmluaXRpb24ucGVyY2VudF9jaGFuY2VfZXh0cmF9JWA7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geWllbGRfbnVtLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IHtcclxuICAgICAgICAgICAgLy8gc2xpZ2h0IGhhY2sgLS0gcmVwcmVzZW50IGFzIGEgKyBiLzEwMFxyXG4gICAgICAgICAgICBsZXQgYV9udW0gPSAoYS5kZWZpbml0aW9uLnlpZWxkID8/IDEpICsgKGEuZGVmaW5pdGlvbi5wZXJjZW50X2NoYW5jZV9leHRyYSA/PyAwKSAvIDEwMDtcclxuICAgICAgICAgICAgbGV0IGJfbnVtID0gKGIuZGVmaW5pdGlvbi55aWVsZCA/PyAxKSArIChiLmRlZmluaXRpb24ucGVyY2VudF9jaGFuY2VfZXh0cmEgPz8gMCkgLyAxMDA7XHJcbiAgICAgICAgICAgIHJldHVybiBhX251bSAtIGJfbnVtO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJVc2VmdWwgRGF5c1wiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IGNyb3AudXNlZnVsX2RheXMudG9TdHJpbmcoKSxcclxuICAgICAgICBjb21wYXJlOiAoYTogQ3JvcERhdGEsIGI6IENyb3BEYXRhKSA9PiBhLnVzZWZ1bF9kYXlzIC0gYi51c2VmdWxfZGF5cyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJOdW0gSGFydmVzdHNcIixcclxuICAgICAgICBjZWxsVGV4dDogKGNyb3A6IENyb3BEYXRhKSA9PiBjcm9wLm51bV9oYXJ2ZXN0cy50b1N0cmluZygpLFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEubnVtX2Nyb3BzIC0gYi5udW1fY3JvcHMsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiTnVtIENyb3BzXCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgbnVtX2Nyb3BzID0gY3JvcC5udW1fY3JvcHM7XHJcbiAgICAgICAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG51bV9jcm9wcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudW1fY3JvcHMudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY3JvcC5udW1fY3JvcHMudG9GaXhlZCgyKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEubnVtX2Nyb3BzIC0gYi5udW1fY3JvcHMsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiUHJvZml0XCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gY3JvcC5wcm9maXQudG9GaXhlZCgyKSxcclxuICAgICAgICBjb21wYXJlOiAoYTogQ3JvcERhdGEsIGI6IENyb3BEYXRhKSA9PiBhLnByb2ZpdCAtIGIucHJvZml0LFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkRhaWx5IFByb2ZpdFwiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IHtcclxuICAgICAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShjcm9wLmRhaWx5X3Byb2ZpdCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjcm9wLmRhaWx5X3Byb2ZpdC50b0ZpeGVkKDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBcIi1cIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEuZGFpbHlfcHJvZml0IC0gYi5kYWlseV9wcm9maXQsXHJcbiAgICB9XHJcbl07XHJcblxyXG5jbGFzcyBDcm9wUm93IHtcclxuICAgIGRhdGE6IENyb3BEYXRhO1xyXG4gICAgcm93OiBIVE1MVGFibGVSb3dFbGVtZW50O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHJvdzogSFRNTFRhYmxlUm93RWxlbWVudCwgZGF0YTogQ3JvcERhdGEpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMucm93ID0gcm93O1xyXG5cclxuICAgICAgICAvLyBub3cgcG9wdWxhdGUgdGhlIHJvd1xyXG4gICAgICAgIGZvciAobGV0IGNvbCBvZiBDT0xVTU5TKSB7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IGNvbC5jZWxsVGV4dCh0aGlzLmRhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLnJvdy5pbnNlcnRDZWxsKCkuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbnR5cGUgU29ydERpcmVjdGlvbiA9IFwiYXNjZW5kaW5nXCIgfCBcImRlc2NlbmRpbmdcIjtcclxuZnVuY3Rpb24gZmxpcERpcmVjdGlvbih4OiBTb3J0RGlyZWN0aW9uKTogU29ydERpcmVjdGlvbiB7XHJcbiAgICBzd2l0Y2ggKHgpIHtcclxuICAgICAgICBjYXNlIFwiYXNjZW5kaW5nXCI6XHJcbiAgICAgICAgICAgIHJldHVybiBcImRlc2NlbmRpbmdcIjtcclxuICAgICAgICBjYXNlIFwiZGVzY2VuZGluZ1wiOlxyXG4gICAgICAgICAgICByZXR1cm4gXCJhc2NlbmRpbmdcIjtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgQ3JvcFRhYmxlIHtcclxuICAgIHRhYmxlOiBIVE1MVGFibGVFbGVtZW50O1xyXG4gICAgdGhlYWQ6IEhUTUxUYWJsZVNlY3Rpb25FbGVtZW50O1xyXG4gICAgdGJvZHk6IEhUTUxUYWJsZVNlY3Rpb25FbGVtZW50O1xyXG4gICAgcm93czogQ3JvcFJvd1tdO1xyXG4gICAgY3VycmVudF9zb3J0OiBbbnVtYmVyLCBTb3J0RGlyZWN0aW9uXSB8IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IodGFibGU6IEhUTUxUYWJsZUVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLnRhYmxlID0gdGFibGU7XHJcbiAgICAgICAgdGhpcy5yb3dzID0gW107XHJcbiAgICAgICAgdGhpcy5jdXJyZW50X3NvcnQgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgdGFibGUgaGVhZGVyIGFuZCBib2R5XHJcbiAgICAgICAgdGhpcy50aGVhZCA9IHRoaXMudGFibGUuY3JlYXRlVEhlYWQoKTtcclxuICAgICAgICB0aGlzLnRib2R5ID0gdGhpcy50YWJsZS5jcmVhdGVUQm9keSgpO1xyXG5cclxuICAgICAgICAvLyBQb3B1bGF0ZSBoZWFkIG9uY2UsIGhlcmVcclxuICAgICAgICBsZXQgcm93ID0gdGhpcy50aGVhZC5pbnNlcnRSb3coKTtcclxuICAgICAgICBmb3IgKGxldCBbaWR4LCBjb2xdIG9mIENPTFVNTlMuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIGxldCBjZWxsID0gcm93Lmluc2VydENlbGwoKTtcclxuICAgICAgICAgICAgY2VsbC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjb2wubmFtZSkpO1xyXG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIFdoaWNoIHdheSBkbyB3ZSBzb3J0P1xyXG4gICAgICAgICAgICAgICAgbGV0IGRpcjogU29ydERpcmVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfc29ydCAhPT0gbnVsbCAmJiB0aGlzLmN1cnJlbnRfc29ydFswXSA9PT0gaWR4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlyID0gZmxpcERpcmVjdGlvbih0aGlzLmN1cnJlbnRfc29ydFsxXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpciA9IFwiYXNjZW5kaW5nXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfc29ydCA9IFtpZHgsIGRpcl07XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgYWxsIHRoZSBoZWFkZXIgYnV0dG9ucywgZXhjZXB0IG91cnNlbHZlc1xyXG4gICAgICAgICAgICAgICAgbGV0IGhlYWRlcnMgPSB0aGlzLnRoZWFkLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkJyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBoZWFkZXIgb2YgaGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlci5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLXNvcnRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzW2lkeF0uc2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIsIGRpcik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gTm93IHNvcnQgdGhlIHJvd3NcclxuICAgICAgICAgICAgICAgIHRoaXMuc29ydFJvd3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBXZSdsbCBsZWF2ZSB0aGUgYm9keSBlbXB0eSBiZWNhdXNlIGl0J2xsIGJlIHJlY29tcHV0ZWQgZnJvbVxyXG4gICAgICAgIC8vIHJlcG9wdWxhdGVUYWJsZSgpLCBhbmQgd2UgbmVlZCB0aGUgc2V0dGluZ3MgdG8gYmUgYWJsZSB0b1xyXG4gICAgICAgIC8vIGNyZWF0ZSB0aGUgcm93cyBhbnl3YXlzLlxyXG4gICAgfVxyXG5cclxuICAgIC8vIFRPRE86IGRvbid0IHJlY3JlYXRlIHJvd3M7IGNoYW5nZSB0aGUgdGV4dCBpbnN0ZWFkXHJcbiAgICBwdWJsaWMgcmVwb3B1bGF0ZVRhYmxlKHNldHRpbmdzOiBTZXR0aW5ncykge1xyXG4gICAgICAgIC8vIERpc2NhcmQgdGhlIG9sZCByb3dzIGFuZCBjcmVhdGUgbmV3IG9uZXNcclxuICAgICAgICB0aGlzLnRib2R5LnJlcGxhY2VDaGlsZHJlbigpO1xyXG4gICAgICAgIHRoaXMucm93cyA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGRlZiBvZiBDUk9QX0RFRklOSVRJT05TKSB7XHJcbiAgICAgICAgICAgIC8vIEZpbHRlciB0byBjcm9wcyB0aGF0IGFyZSBpbi1zZWFzb25cclxuICAgICAgICAgICAgbGV0IGRhdGEgPSBjYWxjdWxhdGUoZGVmLCBzZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhID09IFwib3V0LW9mLXNlYXNvblwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgcm93ID0gdGhpcy50Ym9keS5pbnNlcnRSb3coKTtcclxuICAgICAgICAgICAgdGhpcy5yb3dzLnB1c2gobmV3IENyb3BSb3cocm93LCBkYXRhKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBXZSBhbHNvIG5lZWQgdG8gcmUtc29ydCB0aGVtLiBcclxuICAgICAgICB0aGlzLnNvcnRSb3dzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzb3J0Um93cygpIHtcclxuICAgICAgICAvLyBJZiBubyBzb3J0IHNlbGVjdGVkLCBkZWZhdWx0IGlzIHRvIHNvcnQgYnkgbmFtZVxyXG4gICAgICAgIGxldCBpZHg6IG51bWJlcjtcclxuICAgICAgICBsZXQgZGlyOiBTb3J0RGlyZWN0aW9uO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRfc29ydCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZHggPSAwO1xyXG4gICAgICAgICAgICBkaXIgPSBcImFzY2VuZGluZ1wiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIFtpZHgsIGRpcl0gPSB0aGlzLmN1cnJlbnRfc29ydDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFdlIGZpcnN0IHNvcnQgb3VyIG93biBjb2xsZWN0aW9uLCB0aGVuIHVzZSB0aGF0IHRvIHJlLWluc2VydFxyXG4gICAgICAgIC8vIG91ciByb3cgZWxlbWVudHMuXHJcbiAgICAgICAgbGV0IGNvbCA9IENPTFVNTlNbaWR4XTtcclxuICAgICAgICB0aGlzLnJvd3Muc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY29tcGFyZSA9IGNvbC5jb21wYXJlKGEuZGF0YSwgYi5kYXRhKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRpciA9PT0gXCJhc2NlbmRpbmdcIiA/IGNvbXBhcmUgOiAtY29tcGFyZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gVGhlbiB1c2UgdGhhdCB0byByZWFycmFuZ2UgdGhlIG5vZGVzIGluIHRoZSBib2R5XHJcbiAgICAgICAgZm9yIChsZXQgcm93IG9mIHRoaXMucm93cykge1xyXG4gICAgICAgICAgICB0aGlzLnRib2R5LmFwcGVuZENoaWxkKHJvdy5yb3cpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIVwiKTtcclxuXHJcbiAgICAvLyBGaW5kIGFsbCB0aGUgZWxlbWVudHMgSSBuZWVkXHJcbiAgICBsZXQgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNyb3AtdGFibGVcIik7XHJcbiAgICBpZiAoISh0YWJsZSBpbnN0YW5jZW9mIEhUTUxUYWJsZUVsZW1lbnQpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY3JvcC10YWJsZSBzaG91bGQgYmUgYSA8dGFibGU+XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBpbnB1dF9wYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5wdXQtcGFuZWxcIikhO1xyXG4gICAgbGV0IHNlYXNvbl9pbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTElucHV0RWxlbWVudD4oXCIjc2Vhc29uXCIpITtcclxuICAgIGxldCBjdXJyZW50X2RheV9pbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTElucHV0RWxlbWVudD4oXCIjZGF5XCIpITtcclxuICAgIGxldCBlbmFibGVfbXVsdGlzZWFzb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KFwiI2VuYWJsZS1tdWx0aXNlYXNvblwiKSE7XHJcbiAgICBsZXQgZW5hYmxlX3F1YWxpdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KFwiI2VuYWJsZS1xdWFsaXR5XCIpITtcclxuICAgIGxldCBmYXJtaW5nX2xldmVsX2lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MSW5wdXRFbGVtZW50PihcIiNmYXJtZXItbGV2ZWxcIikhO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0YWJsZSBjb21wb25lbnRcclxuICAgIGxldCB0YWJsZV9jb21wb25lbnQgPSBuZXcgQ3JvcFRhYmxlKHRhYmxlKTtcclxuXHJcbiAgICAvLyBBcHBsaWVzIHRoZSBpbnB1dCBzZXR0aW5ncyB0byB0aGUgZG9jdW1lbnRcclxuICAgIGZ1bmN0aW9uIHJlYWRBbmRBcHBseVNldHRpbmdzKCkge1xyXG4gICAgICAgIC8vIENvbXB1dGUgcXVhbGl0eSBwcm9iYWJsaXRpZXNcclxuICAgICAgICBsZXQgcXVhbGl0eSA9IGNvbXB1dGVRdWFsaXR5KGZhcm1pbmdfbGV2ZWxfaW5wdXQudmFsdWVBc051bWJlcik7XHJcbiAgICAgICAgbGV0IHF1YWxpdHlfZmFjdG9yID0gcXVhbGl0eS5ub3JtYWwgKyBxdWFsaXR5LnNpbHZlciAqIDEuMjUgKyBxdWFsaXR5LmdvbGQgKiAxLjUgKyBxdWFsaXR5LmlyaWRpdW0gKiAyLjA7XHJcblxyXG4gICAgICAgIC8vIEdldCB0aGUgc2V0dGluZ3NcclxuICAgICAgICBsZXQgc2V0dGluZ3M6IFNldHRpbmdzID0ge1xyXG4gICAgICAgICAgICBzZWFzb246IFNlYXNvbi5mcm9tU3RyaW5nKHNlYXNvbl9pbnB1dC52YWx1ZSksXHJcbiAgICAgICAgICAgIHN0YXJ0X2RheTogY3VycmVudF9kYXlfaW5wdXQudmFsdWVBc051bWJlcixcclxuICAgICAgICAgICAgbXVsdGlzZWFzb25fZW5hYmxlZDogZW5hYmxlX211bHRpc2Vhc29uLmNoZWNrZWQsXHJcbiAgICAgICAgICAgIHF1YWxpdHlfcHJvYmFiaWxpdGllczogZW5hYmxlX3F1YWxpdHkuY2hlY2tlZCA/IHF1YWxpdHkgOiBudWxsLFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIFJlcG9wdWxhdGUgdGFibGUgYW5kIGNoYW5nZSBzdHlsZVxyXG4gICAgICAgIHRhYmxlX2NvbXBvbmVudC5yZXBvcHVsYXRlVGFibGUoc2V0dGluZ3MpO1xyXG4gICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc05hbWUgPSBzZWFzb25faW5wdXQudmFsdWUudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICAgICAgLy8gU2V0IHRoZSBxdWFsaXR5IHNldHRpbmdzXHJcbiAgICAgICAgLy8gVE9ETzogZ2V0IHRoZXNlIGVsZW1lbnRzIGFoZWFkIG9mIHRpbWUsIHN0b3AgcXVlcnlpbmcgZXZlcnkgdGltZVxyXG4gICAgICAgIGxldCBrZXk6IGtleW9mIFF1YWxpdHlQcm9iYWJpbGl0aWVzO1xyXG4gICAgICAgIGZvciAoa2V5IGluIHF1YWxpdHkpIHtcclxuICAgICAgICAgICAgbGV0IGNlbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgcGVyY2VudC0ke2tleX1gKSE7XHJcbiAgICAgICAgICAgIGxldCBwZXJjZW50ID0gMTAwICogcXVhbGl0eVtrZXldO1xyXG4gICAgICAgICAgICBjZWxsLnRleHRDb250ZW50ID0gYCR7cGVyY2VudC50b0ZpeGVkKDApfSVgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImF2ZXJhZ2UtcXVhbGl0eVwiKSEudGV4dENvbnRlbnQgPSBxdWFsaXR5X2ZhY3Rvci50b0ZpeGVkKDIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJ1biBpdCBvbmNlIHRvIGFwcGx5IHRoZSBkZWZhdWx0IHNldHRpbmdzLlxyXG4gICAgcmVhZEFuZEFwcGx5U2V0dGluZ3MoKTtcclxuXHJcbiAgICAvLyBBdHRhY2ggZXZlbnQgbGlzdGVuZXJzXHJcbiAgICBpbnB1dF9wYW5lbC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgIHJlYWRBbmRBcHBseVNldHRpbmdzKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbi8vIEFscmlnaHR5LCB3ZSdyZSByZWFkeSB0byBnbyEgV2FpdCBmb3IgdGhlIERPTSB0byBmaW5pc2ggbG9hZGluZyAob3Igc2VlIGlmIGl0XHJcbi8vIGFscmVhZHkgaGFzLlxyXG5pZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJsb2FkaW5nXCIpIHtcclxuICAgIC8vIExvYWRpbmcgaGFzbid0IGZpbmlzaGVkIHlldFxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgaW5pdGlhbGl6ZSk7XHJcbn0gZWxzZSB7XHJcbiAgICAvLyBgRE9NQ29udGVudExvYWRlZGAgaGFzIGFscmVhZHkgZmlyZWRcclxuICAgIGluaXRpYWxpemUoKTtcclxufSJdLCJuYW1lcyI6WyJTZWFzb24iLCJmcm9tU3RyaW5nIiwicyIsInRvVXBwZXJDYXNlIiwiU1BSSU5HIiwiU1VNTUVSIiwiRkFMTCIsIldJTlRFUiIsIkVycm9yIiwiU0lMVkVSX01VTFRJUExJRVIiLCJHT0xEX01VTFRJUExJRVIiLCJJUklESVVNX01VTFRJUExJRVIiLCJjYWxjdWxhdGUiLCJjcm9wIiwic2V0dGluZ3MiLCJzZWFzb25zIiwibnVtX3NlYXNvbnMiLCJtdWx0aXNlYXNvbiIsImkiLCJwdXNoIiwic2Vhc29uIiwidmFsdWVPZiIsImluY2x1ZGVzIiwiZGF5c19sZWZ0IiwibXVsdGlzZWFzb25fZW5hYmxlZCIsImxlbmd0aCIsImluZGV4T2YiLCJzdGFydF9kYXkiLCJudW1faGFydmVzdHMiLCJ1c2VmdWxfZGF5cyIsImRheXNfdG9fZ3JvdyIsInJlZ3Jvd3RoX3BlcmlvZCIsImV4dHJhX2hhcnZlc3RzIiwiTWF0aCIsImZsb29yIiwicXVhbGl0eV9wcmljZSIsImJhc2VfcHJpY2UiLCJzZWxsX3ByaWNlIiwicXVhbGl0eV9wcm9iYWJpbGl0aWVzIiwicSIsIm5vcm1hbCIsInNpbHZlciIsImdvbGQiLCJpcmlkaXVtIiwibWFwIiwibXVsdGlwbGllciIsInAiLCJ0cnVuYyIsInJlZHVjZSIsImEiLCJiIiwibnVtX2Nyb3BzX3Blcl9oYXJ2ZXN0IiwieWllbGQiLCJwZXJjZW50X2NoYW5jZV9leHRyYSIsInByb2ZpdCIsInNlZWRfY29zdCIsImRlZmluaXRpb24iLCJudW1fY3JvcHMiLCJkYWlseV9wcm9maXQiLCJDT0xVTU5TIiwibmFtZSIsImNlbGxUZXh0IiwiY29tcGFyZSIsImxvY2FsZUNvbXBhcmUiLCJ0b1N0cmluZyIsInVuZGVmaW5lZCIsInlpZWxkX251bSIsIk51bWJlciIsImlzSW50ZWdlciIsInRvRml4ZWQiLCJpc0Zpbml0ZSIsIkNyb3BSb3ciLCJjb25zdHJ1Y3RvciIsInJvdyIsImRhdGEiLCJ0aGlzIiwiY29sIiwidmFsdWUiLCJpbnNlcnRDZWxsIiwiYXBwZW5kQ2hpbGQiLCJkb2N1bWVudCIsImNyZWF0ZVRleHROb2RlIiwiZmxpcERpcmVjdGlvbiIsIngiLCJDcm9wVGFibGUiLCJ0YWJsZSIsInJvd3MiLCJjdXJyZW50X3NvcnQiLCJ0aGVhZCIsImNyZWF0ZVRIZWFkIiwidGJvZHkiLCJjcmVhdGVUQm9keSIsImluc2VydFJvdyIsImlkeCIsImVudHJpZXMiLCJjZWxsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiZGlyIiwiaGVhZGVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJoZWFkZXIiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJzb3J0Um93cyIsInJlcG9wdWxhdGVUYWJsZSIsInJlcGxhY2VDaGlsZHJlbiIsImRlZiIsInNvcnQiLCJpbml0aWFsaXplIiwiY29uc29sZSIsImxvZyIsImdldEVsZW1lbnRCeUlkIiwiSFRNTFRhYmxlRWxlbWVudCIsImlucHV0X3BhbmVsIiwic2Vhc29uX2lucHV0IiwicXVlcnlTZWxlY3RvciIsImN1cnJlbnRfZGF5X2lucHV0IiwiZW5hYmxlX211bHRpc2Vhc29uIiwiZW5hYmxlX3F1YWxpdHkiLCJmYXJtaW5nX2xldmVsX2lucHV0IiwidGFibGVfY29tcG9uZW50IiwicmVhZEFuZEFwcGx5U2V0dGluZ3MiLCJrZXkiLCJxdWFsaXR5IiwiZmFybWluZ19sZXZlbCIsInBfZ29sZF9jb2luIiwicF9pcmlkaXVtX2NvaW4iLCJtaW4iLCJjb21wdXRlUXVhbGl0eSIsInZhbHVlQXNOdW1iZXIiLCJxdWFsaXR5X2ZhY3RvciIsImNoZWNrZWQiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGFzc05hbWUiLCJ0b0xvd2VyQ2FzZSIsInBlcmNlbnQiLCJ0ZXh0Q29udGVudCIsInJlYWR5U3RhdGUiXSwic291cmNlUm9vdCI6IiJ9