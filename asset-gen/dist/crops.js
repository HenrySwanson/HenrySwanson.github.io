(()=>{"use strict";const e=JSON.parse('[{"name":"Blue Jazz","season":"Spring","seed_cost":30,"sell_price":50,"days_to_grow":7},{"name":"Carrot","season":"Spring","seed_cost":0,"sell_price":35,"days_to_grow":3},{"name":"Cauliflower","season":"Spring","seed_cost":80,"sell_price":175,"days_to_grow":12},{"name":"Coffee Bean","season":"Spring","multiseason":2,"seed_cost":15,"sell_price":15,"days_to_grow":10,"regrowth_period":2,"yield":4,"percent_chance_extra":2},{"name":"Garlic","season":"Spring","seed_cost":40,"sell_price":60,"days_to_grow":4},{"name":"Green Bean","season":"Spring","seed_cost":60,"sell_price":40,"days_to_grow":10,"regrowth_period":3},{"name":"Kale","season":"Spring","seed_cost":70,"sell_price":110,"days_to_grow":6},{"name":"Parsnip","season":"Spring","seed_cost":20,"sell_price":35,"days_to_grow":4},{"name":"Potato","season":"Spring","seed_cost":50,"sell_price":80,"days_to_grow":6,"percent_chance_extra":25},{"name":"Rhubarb","season":"Spring","seed_cost":100,"sell_price":220,"days_to_grow":13},{"name":"Rice","season":"Spring","seed_cost":40,"sell_price":30,"days_to_grow":6},{"name":"Strawberry","season":"Spring","seed_cost":100,"sell_price":120,"days_to_grow":8,"regrowth_period":4,"percent_chance_extra":2},{"name":"Tulip","season":"Spring","seed_cost":20,"sell_price":30,"days_to_grow":6},{"name":"Blueberry","season":"Summer","seed_cost":80,"sell_price":50,"days_to_grow":13,"regrowth_period":4,"yield":3,"percent_chance_extra":2},{"name":"Corn","season":"Summer","multiseason":2,"seed_cost":150,"sell_price":50,"days_to_grow":14,"regrowth_period":4},{"name":"Hops","season":"Summer","seed_cost":60,"sell_price":25,"days_to_grow":11,"regrowth_period":1},{"name":"Hot Pepper","season":"Summer","seed_cost":40,"sell_price":40,"days_to_grow":5,"regrowth_period":3,"percent_chance_extra":3},{"name":"Melon","season":"Summer","seed_cost":80,"sell_price":250,"days_to_grow":12},{"name":"Poppy","season":"Summer","seed_cost":100,"sell_price":140,"days_to_grow":7},{"name":"Radish","season":"Summer","seed_cost":40,"sell_price":90,"days_to_grow":6},{"name":"Red Cabbage","season":"Summer","seed_cost":100,"sell_price":260,"days_to_grow":9},{"name":"Starfruit","season":"Summer","seed_cost":400,"sell_price":750,"days_to_grow":13},{"name":"Summer Spangle","season":"Summer","seed_cost":50,"sell_price":90,"days_to_grow":8},{"name":"Summer Squash","season":"Summer","seed_cost":0,"sell_price":45,"days_to_grow":6},{"name":"Sunflower","season":"Summer","multiseason":2,"seed_cost":200,"sell_price":80,"days_to_grow":8},{"name":"Tomato","season":"Summer","seed_cost":50,"sell_price":60,"days_to_grow":11,"regrowth_period":4,"percent_chance_extra":5},{"name":"Wheat","season":"Summer","multiseason":2,"seed_cost":10,"sell_price":25,"days_to_grow":4},{"name":"Amaranth","season":"Fall","seed_cost":70,"sell_price":150,"days_to_grow":7},{"name":"Artichoke","season":"Fall","seed_cost":30,"sell_price":160,"days_to_grow":8},{"name":"Beet","season":"Fall","seed_cost":20,"sell_price":100,"days_to_grow":6},{"name":"Bok Choy","season":"Fall","seed_cost":50,"sell_price":80,"days_to_grow":4},{"name":"Broccoli","season":"Fall","seed_cost":0,"sell_price":70,"days_to_grow":8},{"name":"Cranberries","season":"Fall","seed_cost":240,"sell_price":75,"days_to_grow":7,"regrowth_period":5,"yield":2,"percent_chance_extra":10},{"name":"Eggplant","season":"Fall","seed_cost":20,"sell_price":60,"days_to_grow":5,"regrowth_period":5,"percent_chance_extra":0.2},{"name":"Fairy Rose","season":"Fall","seed_cost":200,"sell_price":290,"days_to_grow":12},{"name":"Grape","season":"Fall","seed_cost":60,"sell_price":80,"days_to_grow":10,"regrowth_period":3},{"name":"Pumpkin","season":"Fall","seed_cost":100,"sell_price":320,"days_to_grow":13},{"name":"Yam","season":"Fall","seed_cost":60,"sell_price":160,"days_to_grow":10},{"name":"Powdermelon","season":"Winter","seed_cost":0,"sell_price":60,"days_to_grow":7}]');var o;!function(e){e[e.SPRING=0]="SPRING",e[e.SUMMER=1]="SUMMER",e[e.FALL=2]="FALL",e[e.WINTER=3]="WINTER"}(o||(o={})),function(e){e.fromString=function(o){switch(o.toUpperCase()){case"SPRING":return e.SPRING;case"SUMMER":return e.SUMMER;case"FALL":return e.FALL;case"WINTER":return e.WINTER;default:throw new Error(`Unknown season ${o}`)}}}(o||(o={}));const t=1.25,s=1.5,r=2;function n(e,n){var a,i,l;const c=[],_=null!==(a=e.multiseason)&&void 0!==a?a:1;for(let t=0;t<_;t++)c.push(o.fromString(e.season).valueOf()+t);if(!c.includes(n.season))return"out-of-season";const d=28*(n.multiseason_enabled?c.length-c.indexOf(n.season):1)-n.start_day;let m=0,p=0;if(d>=e.days_to_grow&&(m+=1,p+=e.days_to_grow,e.regrowth_period)){const o=Math.floor((d-e.days_to_grow)/e.regrowth_period);m+=o,p+=o*e.regrowth_period}const u=e.sell_price;let g;if(n.quality_probabilities){const e=n.quality_probabilities;g=[[1,e.normal],[t,e.silver],[s,e.gold],[r,e.iridium]].map((([e,o])=>Math.trunc(e*u)*o)).reduce(((e,o)=>e+o))}else g=u;const w=(null!==(i=e.yield)&&void 0!==i?i:1)+(null!==(l=e.percent_chance_extra)&&void 0!==l?l:0)/100,y=(g+(w-1)*u)*m-e.seed_cost;return{definition:e,useful_days:p,num_harvests:m,num_crops:w*m,profit:y,daily_profit:y/p}}const a=[{name:"Name",cellText:e=>e.definition.name,compare:(e,o)=>e.definition.name.localeCompare(o.definition.name)},{name:"Seed Cost",cellText:e=>e.definition.seed_cost.toString(),compare:(e,o)=>e.definition.seed_cost-o.definition.seed_cost},{name:"Sell Price",cellText:e=>e.definition.sell_price.toString(),compare:(e,o)=>e.definition.sell_price-o.definition.sell_price},{name:"Days to Grow",cellText:e=>e.definition.days_to_grow.toString(),compare:(e,o)=>e.definition.days_to_grow-o.definition.days_to_grow},{name:"Regrowth Period",cellText:e=>{var o,t;return null!==(t=null===(o=e.definition.regrowth_period)||void 0===o?void 0:o.toString())&&void 0!==t?t:"-"},compare:(e,o)=>void 0===o.definition.regrowth_period?-1:void 0===e.definition.regrowth_period?1:e.definition.regrowth_period-o.definition.regrowth_period},{name:"Yield",cellText:e=>{var o;const t=null!==(o=e.definition.yield)&&void 0!==o?o:1;return e.definition.percent_chance_extra?`${t} + ${e.definition.percent_chance_extra}%`:t.toString()},compare:(e,o)=>{var t,s,r,n;return(null!==(t=e.definition.yield)&&void 0!==t?t:1)+(null!==(s=e.definition.percent_chance_extra)&&void 0!==s?s:0)/100-((null!==(r=o.definition.yield)&&void 0!==r?r:1)+(null!==(n=o.definition.percent_chance_extra)&&void 0!==n?n:0)/100)}},{name:"Useful Days",cellText:e=>e.useful_days.toString(),compare:(e,o)=>e.useful_days-o.useful_days},{name:"Num Harvests",cellText:e=>e.num_harvests.toString(),compare:(e,o)=>e.num_crops-o.num_crops},{name:"Num Crops",cellText:e=>{const o=e.num_crops;return Number.isInteger(o)?o.toString():e.num_crops.toFixed(2)},compare:(e,o)=>e.num_crops-o.num_crops},{name:"Profit",cellText:e=>e.profit.toFixed(2),compare:(e,o)=>e.profit-o.profit},{name:"Daily Profit",cellText:e=>Number.isFinite(e.daily_profit)?e.daily_profit.toFixed(2):"-",compare:(e,o)=>e.daily_profit-o.daily_profit}];class i{constructor(e,o){this.data=o,this.row=e;for(const e of a){const o=e.cellText(this.data);this.row.insertCell().appendChild(document.createTextNode(o))}}}function l(e){switch(e){case"ascending":return"descending";case"descending":return"ascending"}}class c{constructor(e){this.table=e,this.rows=[],this.current_sort=null,this.thead=this.table.createTHead(),this.tbody=this.table.createTBody();const o=this.thead.insertRow();for(const[e,t]of a.entries()){const s=o.insertCell();s.appendChild(document.createTextNode(t.name)),s.addEventListener("click",(()=>{let o;o=null!==this.current_sort&&this.current_sort[0]===e?l(this.current_sort[1]):"ascending",this.current_sort=[e,o];const t=this.thead.querySelectorAll("td");for(const e of t)e.removeAttribute("aria-sort");t[e].setAttribute("aria-sort",o),this.sortRows()}))}}repopulateTable(o){this.tbody.replaceChildren(),this.rows=[];for(const t of e){const e=n(t,o);if("out-of-season"==e)continue;const s=this.tbody.insertRow();this.rows.push(new i(s,e))}this.sortRows()}sortRows(){let e,o;null===this.current_sort?(e=0,o="ascending"):[e,o]=this.current_sort;const t=a[e];this.rows.sort(((e,s)=>{const r=t.compare(e.data,s.data);return"ascending"===o?r:-r}));for(const e of this.rows)this.tbody.appendChild(e.row)}}function _(){console.log("Initializing!");const e=document.getElementById("crop-table");if(!(e instanceof HTMLTableElement))throw new Error("crop-table should be a <table>");const t=document.getElementById("input-panel"),s=document.querySelector("#season"),r=document.querySelector("#day"),n=document.querySelector("#enable-multiseason"),a=document.querySelector("#enable-quality"),i=document.querySelector("#farmer-level"),l=new c(e);function _(){const e=function(e){const o=e/10*.2+(e+2)/12*0+.01;let t=o/2;t=0;const s=1*o,r=(1-s)*Math.min(2*o,.75);return{normal:1-s-r,silver:r,gold:s,iridium:0}}(i.valueAsNumber),t=e.normal+1.25*e.silver+1.5*e.gold+2*e.iridium,c={season:o.fromString(s.value),start_day:r.valueAsNumber,multiseason_enabled:n.checked,quality_probabilities:a.checked?e:null};let _;for(_ in l.repopulateTable(c),document.documentElement.className=s.value.toLowerCase(),e){const o=document.getElementById(`percent-${_}`),t=100*e[_];o.textContent=`${t.toFixed(0)}%`}document.getElementById("average-quality").textContent=t.toFixed(2)}_(),t.addEventListener("change",(e=>{_()}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",_):_()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZVksUUFBVVIsRUFBVSxNQVM5RCxJQUFJUyxFQUNKLElBQUtBLEtBTkxYLEVBQWdCaEIsZ0JBQWdCMUYsR0FDaENrRSxTQUFTb0QsZ0JBQWdCQyxVQUFZbkIsRUFBYXJDLE1BQU15RCxjQUs1Q1osRUFBUyxDQUNqQixNQUFNM0IsRUFBT2YsU0FBUytCLGVBQWUsV0FBV29CLEtBQzFDSSxFQUFVLElBQU1iLEVBQVFTLEdBQzlCcEMsRUFBS3lDLFlBQWMsR0FBR0QsRUFBUWxFLFFBQVEsS0FDMUMsQ0FDQVcsU0FBUytCLGVBQWUsbUJBQW9CeUIsWUFBY1AsRUFBZTVELFFBQVEsRUFDckYsQ0FHQW9ELElBR0FSLEVBQVlqQixpQkFBaUIsVUFBV3lDLElBQ3BDaEIsR0FBc0IsR0FFOUIsQ0FLNEIsWUFBeEJ6QyxTQUFTMEQsV0FFVDFELFNBQVNnQixpQkFBaUIsbUJBQW9CWSxHQUc5Q0EsRyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9jcm9wcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbi8vIHNob3VsZCBpIHB1bGwgdGhpcyBmcm9tIGEgSlNPTiBsaWtlIGknbSBkb2luZyBub3c/IG9yIHNob3VsZCBpIGp1c3RcclxuLy8gaGFyZC1jb2RlIGl0IGlubGluZSAobWlnaHQgYmUgbW9yZSByZWFkYWJsZSlcclxuaW1wb3J0IENST1BfREVGSU5JVElPTlMgZnJvbSBcIi4vY3JvcHMuanNvblwiO1xyXG5cclxuLyogPT09PT09PT0gQ0FMQ1VMQVRJT04gPT09PT09PT0gKi9cclxuXHJcbnR5cGUgQ3JvcERlZmluaXRpb24gPSB0eXBlb2YgQ1JPUF9ERUZJTklUSU9OU1tudW1iZXJdO1xyXG5cclxuZW51bSBTZWFzb24ge1xyXG4gICAgU1BSSU5HLCBTVU1NRVIsIEZBTEwsIFdJTlRFUlxyXG59XHJcblxyXG5uYW1lc3BhY2UgU2Vhc29uIHtcclxuICAgIGV4cG9ydCBmdW5jdGlvbiBmcm9tU3RyaW5nKHM6IHN0cmluZyk6IFNlYXNvbiB7XHJcbiAgICAgICAgc3dpdGNoIChzLnRvVXBwZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgY2FzZSBcIlNQUklOR1wiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFNlYXNvbi5TUFJJTkc7XHJcbiAgICAgICAgICAgIGNhc2UgXCJTVU1NRVJcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBTZWFzb24uU1VNTUVSO1xyXG4gICAgICAgICAgICBjYXNlIFwiRkFMTFwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFNlYXNvbi5GQUxMO1xyXG4gICAgICAgICAgICBjYXNlIFwiV0lOVEVSXCI6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gU2Vhc29uLldJTlRFUjtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBzZWFzb24gJHtzfWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxudHlwZSBDcm9wRGF0YSA9IHtcclxuICAgIGRlZmluaXRpb246IENyb3BEZWZpbml0aW9uLFxyXG4gICAgdXNlZnVsX2RheXM6IG51bWJlcixcclxuICAgIG51bV9oYXJ2ZXN0czogbnVtYmVyLFxyXG4gICAgbnVtX2Nyb3BzOiBudW1iZXIsXHJcbiAgICBwcm9maXQ6IG51bWJlcixcclxuICAgIGRhaWx5X3Byb2ZpdDogbnVtYmVyLFxyXG59O1xyXG5cclxudHlwZSBRdWFsaXR5UHJvYmFiaWxpdGllcyA9IHtcclxuICAgIG5vcm1hbDogbnVtYmVyLFxyXG4gICAgc2lsdmVyOiBudW1iZXIsXHJcbiAgICBnb2xkOiBudW1iZXIsXHJcbiAgICBpcmlkaXVtOiBudW1iZXIsXHJcbn07XHJcblxyXG5jb25zdCBTSUxWRVJfTVVMVElQTElFUiA9IDEuMjU7XHJcbmNvbnN0IEdPTERfTVVMVElQTElFUiA9IDEuNTtcclxuY29uc3QgSVJJRElVTV9NVUxUSVBMSUVSID0gMi4wO1xyXG5cclxuZnVuY3Rpb24gY29tcHV0ZVF1YWxpdHkoZmFybWluZ19sZXZlbDogbnVtYmVyKTogUXVhbGl0eVByb2JhYmlsaXRpZXMge1xyXG4gICAgLy8gaHR0cHM6Ly9zdGFyZGV3dmFsbGV5d2lraS5jb20vRmFybWluZyNDb21wbGV0ZV9Gb3JtdWxhXzJcclxuICAgIGNvbnN0IGZlcnRpbGl6ZXJfbGV2ZWwgPSAwO1xyXG5cclxuICAgIC8vIFF1YWxpdHkgZm9yIGEgY3JvcCBpcyBkZXRlcm1pbmVkIGJ5IGEgc2VyaWVzIG9mIHdlaWdodGVkIGNvaW4gZmxpcHMuXHJcbiAgICAvLyBUaGUgcHJvYmFiaWxpdGllcyBmb3IgdGhlIGNvaW5zIGFyZSBjb21wdXRlZCBoZXJlLlxyXG4gICAgY29uc3QgcF9nb2xkX2NvaW4gPSAwLjIgKiAoZmFybWluZ19sZXZlbCAvIDEwLjApICsgMC4yICogZmVydGlsaXplcl9sZXZlbCAqICgoZmFybWluZ19sZXZlbCArIDIuMCkgLyAxMi4wKSArIDAuMDE7XHJcbiAgICBjb25zdCBwX3NpbHZlcl9jb2luID0gTWF0aC5taW4oMiAqIHBfZ29sZF9jb2luLCAwLjc1KTtcclxuICAgIGxldCBwX2lyaWRpdW1fY29pbiA9IHBfZ29sZF9jb2luIC8gMjtcclxuXHJcbiAgICAvLyBUT0RPOiB0aGlzIGlzIG9ubHkgZW5hYmxlZCBhdCBjZXJ0YWluIGZlcnRpbGl6ZXIgbGV2ZWxzXHJcbiAgICBwX2lyaWRpdW1fY29pbiA9IDA7XHJcblxyXG4gICAgLy8gSG93ZXZlciwgdGhlc2UgY29pbnMgYXJlIGZsaXBwZWQgb25lIGF0IGEgdGltZSwgc28gd2UgaGF2ZSBzbGlnaHRseSBtb3JlXHJcbiAgICAvLyB3b3JrIHRvIGRvIHRvIGZpbmQgb3V0IHRoZSBmaW5hbCBwcm9iYWJpbGl0aWVzLlxyXG5cclxuICAgIC8vIENoYW5jZSBvZiBpcmlkaXVtIGlzIGp1c3QgdGhlIGxvY2FsIGNoYW5jZSBvZiBpcmlkaXVtLlxyXG4gICAgY29uc3QgaXJpZGl1bSA9IHBfaXJpZGl1bV9jb2luO1xyXG4gICAgLy8gVG8gZ2V0IGdvbGQsIGRvbid0IGJlIGlyaWRpdW0sIGFuZCBwYXNzIHRoZSBnb2xkIGNvaW4gZmxpcC5cclxuICAgIGNvbnN0IGdvbGQgPSAoMSAtIGlyaWRpdW0pICogcF9nb2xkX2NvaW47XHJcbiAgICAvLyBTaW1pbGFybHksIGZvciBzaWx2ZXIsIGRvbid0IGJlIGlyaWR1bSBvciBnb2xkLCBhbmQgcGFzcyB0aGVcclxuICAgIC8vIHNpbHZlciBjb2luIGZsaXAuXHJcbiAgICBjb25zdCBzaWx2ZXIgPSAoMSAtIGlyaWRpdW0gLSBnb2xkKSAqIHBfc2lsdmVyX2NvaW47XHJcbiAgICAvLyBCYXNlIHF1YWxpdHkgaXMgZXZlcnl0aGluZyBlbHNlLlxyXG4gICAgY29uc3Qgbm9ybWFsID0gMSAtIGlyaWRpdW0gLSBnb2xkIC0gc2lsdmVyO1xyXG5cclxuICAgIHJldHVybiB7IG5vcm1hbCwgc2lsdmVyLCBnb2xkLCBpcmlkaXVtIH07XHJcbn1cclxuXHJcbnR5cGUgU2V0dGluZ3MgPSB7XHJcbiAgICBzZWFzb246IFNlYXNvbixcclxuICAgIHN0YXJ0X2RheTogbnVtYmVyLFxyXG4gICAgbXVsdGlzZWFzb25fZW5hYmxlZDogYm9vbGVhbixcclxuICAgIHF1YWxpdHlfcHJvYmFiaWxpdGllczogUXVhbGl0eVByb2JhYmlsaXRpZXMgfCBudWxsLFxyXG59O1xyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlKGNyb3A6IENyb3BEZWZpbml0aW9uLCBzZXR0aW5nczogU2V0dGluZ3MpOiBDcm9wRGF0YSB8IFwib3V0LW9mLXNlYXNvblwiIHtcclxuICAgIC8vIFdoZW4gaXMgdGhpcyBjcm9wIGluLXNlYXNvbj9cclxuICAgIGNvbnN0IHNlYXNvbnM6IFNlYXNvbltdID0gW107XHJcbiAgICBjb25zdCBudW1fc2Vhc29ucyA9IGNyb3AubXVsdGlzZWFzb24gPz8gMTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtX3NlYXNvbnM7IGkrKykge1xyXG4gICAgICAgIHNlYXNvbnMucHVzaChTZWFzb24uZnJvbVN0cmluZyhjcm9wLnNlYXNvbikudmFsdWVPZigpICsgaSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQmFpbCBvdXQgaWYgd2UncmUgb3V0IG9mIHNlYXNvblxyXG4gICAgaWYgKCFzZWFzb25zLmluY2x1ZGVzKHNldHRpbmdzLnNlYXNvbikpIHtcclxuICAgICAgICByZXR1cm4gXCJvdXQtb2Ytc2Vhc29uXCI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSG93IG1hbnkgZGF5cyBkbyB3ZSBoYXZlIGxlZnQ/XHJcbiAgICBjb25zdCBzZWFzb25zX2xlZnQgPSBzZXR0aW5ncy5tdWx0aXNlYXNvbl9lbmFibGVkXHJcbiAgICAgICAgPyBzZWFzb25zLmxlbmd0aCAtIHNlYXNvbnMuaW5kZXhPZihzZXR0aW5ncy5zZWFzb24pXHJcbiAgICAgICAgOiAxO1xyXG4gICAgY29uc3QgZGF5c19sZWZ0ID0gMjggKiBzZWFzb25zX2xlZnQgLSBzZXR0aW5ncy5zdGFydF9kYXk7XHJcblxyXG4gICAgLy8gSW4gdGhlIG51bWJlciBvZiBkYXlzIHJlbWFpbmluZywgaG93IG1hbnkgaGFydmVzdHMgZG8gd2UgZ2V0P1xyXG4gICAgbGV0IG51bV9oYXJ2ZXN0cyA9IDA7XHJcbiAgICBsZXQgdXNlZnVsX2RheXMgPSAwO1xyXG4gICAgaWYgKGRheXNfbGVmdCA+PSBjcm9wLmRheXNfdG9fZ3Jvdykge1xyXG4gICAgICAgIG51bV9oYXJ2ZXN0cyArPSAxO1xyXG4gICAgICAgIHVzZWZ1bF9kYXlzICs9IGNyb3AuZGF5c190b19ncm93O1xyXG4gICAgICAgIGlmIChjcm9wLnJlZ3Jvd3RoX3BlcmlvZCkge1xyXG4gICAgICAgICAgICBjb25zdCBleHRyYV9oYXJ2ZXN0cyA9IE1hdGguZmxvb3IoKGRheXNfbGVmdCAtIGNyb3AuZGF5c190b19ncm93KSAvIGNyb3AucmVncm93dGhfcGVyaW9kKTtcclxuICAgICAgICAgICAgbnVtX2hhcnZlc3RzICs9IGV4dHJhX2hhcnZlc3RzO1xyXG4gICAgICAgICAgICB1c2VmdWxfZGF5cyArPSBleHRyYV9oYXJ2ZXN0cyAqIGNyb3AucmVncm93dGhfcGVyaW9kO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBIb3cgbXVjaCBpcyBhIGNyb3Agd29ydGgsIG9uIGF2ZXJhZ2U/XHJcbiAgICBjb25zdCBiYXNlX3ByaWNlID0gY3JvcC5zZWxsX3ByaWNlO1xyXG4gICAgbGV0IHF1YWxpdHlfcHJpY2U7XHJcbiAgICBpZiAoc2V0dGluZ3MucXVhbGl0eV9wcm9iYWJpbGl0aWVzKSB7XHJcbiAgICAgICAgY29uc3QgcSA9IHNldHRpbmdzLnF1YWxpdHlfcHJvYmFiaWxpdGllcztcclxuICAgICAgICAvLyB6aXAgdG9nZXRoZXIgcHJpY2VzIGFuZCBwcm9iYWJpbGl0aWVzXHJcbiAgICAgICAgcXVhbGl0eV9wcmljZSA9IFtcclxuICAgICAgICAgICAgWzEuMCwgcS5ub3JtYWxdLFxyXG4gICAgICAgICAgICBbU0lMVkVSX01VTFRJUExJRVIsIHEuc2lsdmVyXSxcclxuICAgICAgICAgICAgW0dPTERfTVVMVElQTElFUiwgcS5nb2xkXSxcclxuICAgICAgICAgICAgW0lSSURJVU1fTVVMVElQTElFUiwgcS5pcmlkaXVtXSxcclxuICAgICAgICBdXHJcbiAgICAgICAgICAgIC8vIHByaWNlcyBhcmUgcm91bmRlZCBkb3duIVxyXG4gICAgICAgICAgICAubWFwKChbbXVsdGlwbGllciwgcF0pID0+IE1hdGgudHJ1bmMobXVsdGlwbGllciAqIGJhc2VfcHJpY2UpICogcClcclxuICAgICAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBxdWFsaXR5X3ByaWNlID0gYmFzZV9wcmljZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBXZSBjYW4gc29tZXRpbWVzIGdldCBtdWx0aXBsZSBjcm9wcyBwZXIgaGFydmVzdCwgYnV0IGFsbCB0aGUgZXh0cmEgY3JvcHNcclxuICAgIC8vIHdpbGwgYmUgcmVndWxhciBxdWFsaXR5LlxyXG4gICAgLy8gVE9ETzogaXMgdGhpcyB0cnVlPyBpIHNlZSBjb25mbGljdGluZyBzb3VyY2VzIG9ubGluZVxyXG4gICAgY29uc3QgbnVtX2Nyb3BzX3Blcl9oYXJ2ZXN0ID0gKGNyb3AueWllbGQgPz8gMSkgKyAoY3JvcC5wZXJjZW50X2NoYW5jZV9leHRyYSA/PyAwKSAvIDEwMC4wO1xyXG4gICAgY29uc3QgcmV2ZW51ZV9wZXJfaGFydmVzdCA9IHF1YWxpdHlfcHJpY2UgKyAobnVtX2Nyb3BzX3Blcl9oYXJ2ZXN0IC0gMSkgKiBiYXNlX3ByaWNlO1xyXG5cclxuICAgIC8vIE9rYXksIGxldCdzIGNhbGN1bGF0ZSBldmVyeXRoaW5nIVxyXG4gICAgY29uc3QgcHJvZml0ID0gcmV2ZW51ZV9wZXJfaGFydmVzdCAqIG51bV9oYXJ2ZXN0cyAtIGNyb3Auc2VlZF9jb3N0O1xyXG4gICAgY29uc3QgZGFpbHlfcHJvZml0ID0gcHJvZml0IC8gdXNlZnVsX2RheXM7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBkZWZpbml0aW9uOiBjcm9wLFxyXG4gICAgICAgIHVzZWZ1bF9kYXlzLFxyXG4gICAgICAgIG51bV9oYXJ2ZXN0cyxcclxuICAgICAgICBudW1fY3JvcHM6IG51bV9jcm9wc19wZXJfaGFydmVzdCAqIG51bV9oYXJ2ZXN0cyxcclxuICAgICAgICBwcm9maXQsXHJcbiAgICAgICAgZGFpbHlfcHJvZml0LFxyXG4gICAgfTtcclxufVxyXG5cclxuLyogPT09PT09PT0gR1VJID09PT09PT09ICovXHJcblxyXG4vLyBEZWZpbmVzIHRoZSBzZXQgb2YgY29sdW1ucyBmb3IgdGhlIHdob2xlIHRhYmxlLlxyXG50eXBlIENvbHVtbiA9IHtcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IHN0cmluZztcclxuICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IG51bWJlcjtcclxufTtcclxuXHJcbmNvbnN0IENPTFVNTlM6IENvbHVtbltdID0gW1xyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiTmFtZVwiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IGNyb3AuZGVmaW5pdGlvbi5uYW1lLFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEuZGVmaW5pdGlvbi5uYW1lLmxvY2FsZUNvbXBhcmUoYi5kZWZpbml0aW9uLm5hbWUpLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIlNlZWQgQ29zdFwiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IGNyb3AuZGVmaW5pdGlvbi5zZWVkX2Nvc3QudG9TdHJpbmcoKSxcclxuICAgICAgICBjb21wYXJlOiAoYTogQ3JvcERhdGEsIGI6IENyb3BEYXRhKSA9PiBhLmRlZmluaXRpb24uc2VlZF9jb3N0IC0gYi5kZWZpbml0aW9uLnNlZWRfY29zdCxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJTZWxsIFByaWNlXCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gY3JvcC5kZWZpbml0aW9uLnNlbGxfcHJpY2UudG9TdHJpbmcoKSxcclxuICAgICAgICBjb21wYXJlOiAoYTogQ3JvcERhdGEsIGI6IENyb3BEYXRhKSA9PiBhLmRlZmluaXRpb24uc2VsbF9wcmljZSAtIGIuZGVmaW5pdGlvbi5zZWxsX3ByaWNlLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkRheXMgdG8gR3Jvd1wiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IGNyb3AuZGVmaW5pdGlvbi5kYXlzX3RvX2dyb3cudG9TdHJpbmcoKSxcclxuICAgICAgICBjb21wYXJlOiAoYTogQ3JvcERhdGEsIGI6IENyb3BEYXRhKSA9PiBhLmRlZmluaXRpb24uZGF5c190b19ncm93IC0gYi5kZWZpbml0aW9uLmRheXNfdG9fZ3JvdyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJSZWdyb3d0aCBQZXJpb2RcIixcclxuICAgICAgICBjZWxsVGV4dDogKGNyb3A6IENyb3BEYXRhKSA9PiBjcm9wLmRlZmluaXRpb24ucmVncm93dGhfcGVyaW9kPy50b1N0cmluZygpID8/IFwiLVwiLFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IHtcclxuICAgICAgICAgICAgaWYgKGIuZGVmaW5pdGlvbi5yZWdyb3d0aF9wZXJpb2QgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGEuZGVmaW5pdGlvbi5yZWdyb3d0aF9wZXJpb2QgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGEuZGVmaW5pdGlvbi5yZWdyb3d0aF9wZXJpb2QgLSBiLmRlZmluaXRpb24ucmVncm93dGhfcGVyaW9kO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJZaWVsZFwiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgeWllbGRfbnVtID0gY3JvcC5kZWZpbml0aW9uLnlpZWxkID8/IDE7XHJcbiAgICAgICAgICAgIGlmIChjcm9wLmRlZmluaXRpb24ucGVyY2VudF9jaGFuY2VfZXh0cmEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgJHt5aWVsZF9udW19ICsgJHtjcm9wLmRlZmluaXRpb24ucGVyY2VudF9jaGFuY2VfZXh0cmF9JWA7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geWllbGRfbnVtLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IHtcclxuICAgICAgICAgICAgLy8gc2xpZ2h0IGhhY2sgLS0gcmVwcmVzZW50IGFzIGEgKyBiLzEwMFxyXG4gICAgICAgICAgICBjb25zdCBhX251bSA9IChhLmRlZmluaXRpb24ueWllbGQgPz8gMSkgKyAoYS5kZWZpbml0aW9uLnBlcmNlbnRfY2hhbmNlX2V4dHJhID8/IDApIC8gMTAwO1xyXG4gICAgICAgICAgICBjb25zdCBiX251bSA9IChiLmRlZmluaXRpb24ueWllbGQgPz8gMSkgKyAoYi5kZWZpbml0aW9uLnBlcmNlbnRfY2hhbmNlX2V4dHJhID8/IDApIC8gMTAwO1xyXG4gICAgICAgICAgICByZXR1cm4gYV9udW0gLSBiX251bTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiVXNlZnVsIERheXNcIixcclxuICAgICAgICBjZWxsVGV4dDogKGNyb3A6IENyb3BEYXRhKSA9PiBjcm9wLnVzZWZ1bF9kYXlzLnRvU3RyaW5nKCksXHJcbiAgICAgICAgY29tcGFyZTogKGE6IENyb3BEYXRhLCBiOiBDcm9wRGF0YSkgPT4gYS51c2VmdWxfZGF5cyAtIGIudXNlZnVsX2RheXMsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiTnVtIEhhcnZlc3RzXCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gY3JvcC5udW1faGFydmVzdHMudG9TdHJpbmcoKSxcclxuICAgICAgICBjb21wYXJlOiAoYTogQ3JvcERhdGEsIGI6IENyb3BEYXRhKSA9PiBhLm51bV9jcm9wcyAtIGIubnVtX2Nyb3BzLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIk51bSBDcm9wc1wiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbnVtX2Nyb3BzID0gY3JvcC5udW1fY3JvcHM7XHJcbiAgICAgICAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG51bV9jcm9wcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudW1fY3JvcHMudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY3JvcC5udW1fY3JvcHMudG9GaXhlZCgyKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEubnVtX2Nyb3BzIC0gYi5udW1fY3JvcHMsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiUHJvZml0XCIsXHJcbiAgICAgICAgY2VsbFRleHQ6IChjcm9wOiBDcm9wRGF0YSkgPT4gY3JvcC5wcm9maXQudG9GaXhlZCgyKSxcclxuICAgICAgICBjb21wYXJlOiAoYTogQ3JvcERhdGEsIGI6IENyb3BEYXRhKSA9PiBhLnByb2ZpdCAtIGIucHJvZml0LFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkRhaWx5IFByb2ZpdFwiLFxyXG4gICAgICAgIGNlbGxUZXh0OiAoY3JvcDogQ3JvcERhdGEpID0+IHtcclxuICAgICAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShjcm9wLmRhaWx5X3Byb2ZpdCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjcm9wLmRhaWx5X3Byb2ZpdC50b0ZpeGVkKDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBcIi1cIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBhcmU6IChhOiBDcm9wRGF0YSwgYjogQ3JvcERhdGEpID0+IGEuZGFpbHlfcHJvZml0IC0gYi5kYWlseV9wcm9maXQsXHJcbiAgICB9XHJcbl07XHJcblxyXG5jbGFzcyBDcm9wUm93IHtcclxuICAgIGRhdGE6IENyb3BEYXRhO1xyXG4gICAgcm93OiBIVE1MVGFibGVSb3dFbGVtZW50O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHJvdzogSFRNTFRhYmxlUm93RWxlbWVudCwgZGF0YTogQ3JvcERhdGEpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMucm93ID0gcm93O1xyXG5cclxuICAgICAgICAvLyBub3cgcG9wdWxhdGUgdGhlIHJvd1xyXG4gICAgICAgIGZvciAoY29uc3QgY29sIG9mIENPTFVNTlMpIHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBjb2wuY2VsbFRleHQodGhpcy5kYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5yb3cuaW5zZXJ0Q2VsbCgpLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG50eXBlIFNvcnREaXJlY3Rpb24gPSBcImFzY2VuZGluZ1wiIHwgXCJkZXNjZW5kaW5nXCI7XHJcbmZ1bmN0aW9uIGZsaXBEaXJlY3Rpb24oeDogU29ydERpcmVjdGlvbik6IFNvcnREaXJlY3Rpb24ge1xyXG4gICAgc3dpdGNoICh4KSB7XHJcbiAgICAgICAgY2FzZSBcImFzY2VuZGluZ1wiOlxyXG4gICAgICAgICAgICByZXR1cm4gXCJkZXNjZW5kaW5nXCI7XHJcbiAgICAgICAgY2FzZSBcImRlc2NlbmRpbmdcIjpcclxuICAgICAgICAgICAgcmV0dXJuIFwiYXNjZW5kaW5nXCI7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIENyb3BUYWJsZSB7XHJcbiAgICB0YWJsZTogSFRNTFRhYmxlRWxlbWVudDtcclxuICAgIHRoZWFkOiBIVE1MVGFibGVTZWN0aW9uRWxlbWVudDtcclxuICAgIHRib2R5OiBIVE1MVGFibGVTZWN0aW9uRWxlbWVudDtcclxuICAgIHJvd3M6IENyb3BSb3dbXTtcclxuICAgIGN1cnJlbnRfc29ydDogW251bWJlciwgU29ydERpcmVjdGlvbl0gfCBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHRhYmxlOiBIVE1MVGFibGVFbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy50YWJsZSA9IHRhYmxlO1xyXG4gICAgICAgIHRoaXMucm93cyA9IFtdO1xyXG4gICAgICAgIHRoaXMuY3VycmVudF9zb3J0ID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIHRhYmxlIGhlYWRlciBhbmQgYm9keVxyXG4gICAgICAgIHRoaXMudGhlYWQgPSB0aGlzLnRhYmxlLmNyZWF0ZVRIZWFkKCk7XHJcbiAgICAgICAgdGhpcy50Ym9keSA9IHRoaXMudGFibGUuY3JlYXRlVEJvZHkoKTtcclxuXHJcbiAgICAgICAgLy8gUG9wdWxhdGUgaGVhZCBvbmNlLCBoZXJlXHJcbiAgICAgICAgY29uc3Qgcm93ID0gdGhpcy50aGVhZC5pbnNlcnRSb3coKTtcclxuICAgICAgICBmb3IgKGNvbnN0IFtpZHgsIGNvbF0gb2YgQ09MVU1OUy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgY29uc3QgY2VsbCA9IHJvdy5pbnNlcnRDZWxsKCk7XHJcbiAgICAgICAgICAgIGNlbGwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY29sLm5hbWUpKTtcclxuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gV2hpY2ggd2F5IGRvIHdlIHNvcnQ/XHJcbiAgICAgICAgICAgICAgICBsZXQgZGlyOiBTb3J0RGlyZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF9zb3J0ICE9PSBudWxsICYmIHRoaXMuY3VycmVudF9zb3J0WzBdID09PSBpZHgpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXIgPSBmbGlwRGlyZWN0aW9uKHRoaXMuY3VycmVudF9zb3J0WzFdKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlyID0gXCJhc2NlbmRpbmdcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9zb3J0ID0gW2lkeCwgZGlyXTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBhbGwgdGhlIGhlYWRlciBidXR0b25zLCBleGNlcHQgb3Vyc2VsdmVzXHJcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdGhpcy50aGVhZC5xdWVyeVNlbGVjdG9yQWxsKCd0ZCcpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBoZWFkZXIgb2YgaGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlci5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLXNvcnRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzW2lkeF0uc2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIsIGRpcik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gTm93IHNvcnQgdGhlIHJvd3NcclxuICAgICAgICAgICAgICAgIHRoaXMuc29ydFJvd3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBXZSdsbCBsZWF2ZSB0aGUgYm9keSBlbXB0eSBiZWNhdXNlIGl0J2xsIGJlIHJlY29tcHV0ZWQgZnJvbVxyXG4gICAgICAgIC8vIHJlcG9wdWxhdGVUYWJsZSgpLCBhbmQgd2UgbmVlZCB0aGUgc2V0dGluZ3MgdG8gYmUgYWJsZSB0b1xyXG4gICAgICAgIC8vIGNyZWF0ZSB0aGUgcm93cyBhbnl3YXlzLlxyXG4gICAgfVxyXG5cclxuICAgIC8vIFRPRE86IGRvbid0IHJlY3JlYXRlIHJvd3M7IGNoYW5nZSB0aGUgdGV4dCBpbnN0ZWFkXHJcbiAgICBwdWJsaWMgcmVwb3B1bGF0ZVRhYmxlKHNldHRpbmdzOiBTZXR0aW5ncykge1xyXG4gICAgICAgIC8vIERpc2NhcmQgdGhlIG9sZCByb3dzIGFuZCBjcmVhdGUgbmV3IG9uZXNcclxuICAgICAgICB0aGlzLnRib2R5LnJlcGxhY2VDaGlsZHJlbigpO1xyXG4gICAgICAgIHRoaXMucm93cyA9IFtdO1xyXG4gICAgICAgIGZvciAoY29uc3QgZGVmIG9mIENST1BfREVGSU5JVElPTlMpIHtcclxuICAgICAgICAgICAgLy8gRmlsdGVyIHRvIGNyb3BzIHRoYXQgYXJlIGluLXNlYXNvblxyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gY2FsY3VsYXRlKGRlZiwgc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YSA9PSBcIm91dC1vZi1zZWFzb25cIikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgcm93ID0gdGhpcy50Ym9keS5pbnNlcnRSb3coKTtcclxuICAgICAgICAgICAgdGhpcy5yb3dzLnB1c2gobmV3IENyb3BSb3cocm93LCBkYXRhKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBXZSBhbHNvIG5lZWQgdG8gcmUtc29ydCB0aGVtLiBcclxuICAgICAgICB0aGlzLnNvcnRSb3dzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzb3J0Um93cygpIHtcclxuICAgICAgICAvLyBJZiBubyBzb3J0IHNlbGVjdGVkLCBkZWZhdWx0IGlzIHRvIHNvcnQgYnkgbmFtZVxyXG4gICAgICAgIGxldCBpZHg6IG51bWJlcjtcclxuICAgICAgICBsZXQgZGlyOiBTb3J0RGlyZWN0aW9uO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRfc29ydCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZHggPSAwO1xyXG4gICAgICAgICAgICBkaXIgPSBcImFzY2VuZGluZ1wiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIFtpZHgsIGRpcl0gPSB0aGlzLmN1cnJlbnRfc29ydDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFdlIGZpcnN0IHNvcnQgb3VyIG93biBjb2xsZWN0aW9uLCB0aGVuIHVzZSB0aGF0IHRvIHJlLWluc2VydFxyXG4gICAgICAgIC8vIG91ciByb3cgZWxlbWVudHMuXHJcbiAgICAgICAgY29uc3QgY29sID0gQ09MVU1OU1tpZHhdO1xyXG4gICAgICAgIHRoaXMucm93cy5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBhcmUgPSBjb2wuY29tcGFyZShhLmRhdGEsIGIuZGF0YSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkaXIgPT09IFwiYXNjZW5kaW5nXCIgPyBjb21wYXJlIDogLWNvbXBhcmU7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFRoZW4gdXNlIHRoYXQgdG8gcmVhcnJhbmdlIHRoZSBub2RlcyBpbiB0aGUgYm9keVxyXG4gICAgICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMucm93cykge1xyXG4gICAgICAgICAgICB0aGlzLnRib2R5LmFwcGVuZENoaWxkKHJvdy5yb3cpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIVwiKTtcclxuXHJcbiAgICAvLyBGaW5kIGFsbCB0aGUgZWxlbWVudHMgSSBuZWVkXHJcbiAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JvcC10YWJsZVwiKTtcclxuICAgIGlmICghKHRhYmxlIGluc3RhbmNlb2YgSFRNTFRhYmxlRWxlbWVudCkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjcm9wLXRhYmxlIHNob3VsZCBiZSBhIDx0YWJsZT5cIik7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaW5wdXRfcGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImlucHV0LXBhbmVsXCIpITtcclxuICAgIGNvbnN0IHNlYXNvbl9pbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTElucHV0RWxlbWVudD4oXCIjc2Vhc29uXCIpITtcclxuICAgIGNvbnN0IGN1cnJlbnRfZGF5X2lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MSW5wdXRFbGVtZW50PihcIiNkYXlcIikhO1xyXG4gICAgY29uc3QgZW5hYmxlX211bHRpc2Vhc29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MSW5wdXRFbGVtZW50PihcIiNlbmFibGUtbXVsdGlzZWFzb25cIikhO1xyXG4gICAgY29uc3QgZW5hYmxlX3F1YWxpdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KFwiI2VuYWJsZS1xdWFsaXR5XCIpITtcclxuICAgIGNvbnN0IGZhcm1pbmdfbGV2ZWxfaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KFwiI2Zhcm1lci1sZXZlbFwiKSE7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRhYmxlIGNvbXBvbmVudFxyXG4gICAgY29uc3QgdGFibGVfY29tcG9uZW50ID0gbmV3IENyb3BUYWJsZSh0YWJsZSk7XHJcblxyXG4gICAgLy8gQXBwbGllcyB0aGUgaW5wdXQgc2V0dGluZ3MgdG8gdGhlIGRvY3VtZW50XHJcbiAgICBmdW5jdGlvbiByZWFkQW5kQXBwbHlTZXR0aW5ncygpIHtcclxuICAgICAgICAvLyBDb21wdXRlIHF1YWxpdHkgcHJvYmFibGl0aWVzXHJcbiAgICAgICAgY29uc3QgcXVhbGl0eSA9IGNvbXB1dGVRdWFsaXR5KGZhcm1pbmdfbGV2ZWxfaW5wdXQudmFsdWVBc051bWJlcik7XHJcbiAgICAgICAgY29uc3QgcXVhbGl0eV9mYWN0b3IgPSBxdWFsaXR5Lm5vcm1hbCArIHF1YWxpdHkuc2lsdmVyICogMS4yNSArIHF1YWxpdHkuZ29sZCAqIDEuNSArIHF1YWxpdHkuaXJpZGl1bSAqIDIuMDtcclxuXHJcbiAgICAgICAgLy8gR2V0IHRoZSBzZXR0aW5nc1xyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzOiBTZXR0aW5ncyA9IHtcclxuICAgICAgICAgICAgc2Vhc29uOiBTZWFzb24uZnJvbVN0cmluZyhzZWFzb25faW5wdXQudmFsdWUpLFxyXG4gICAgICAgICAgICBzdGFydF9kYXk6IGN1cnJlbnRfZGF5X2lucHV0LnZhbHVlQXNOdW1iZXIsXHJcbiAgICAgICAgICAgIG11bHRpc2Vhc29uX2VuYWJsZWQ6IGVuYWJsZV9tdWx0aXNlYXNvbi5jaGVja2VkLFxyXG4gICAgICAgICAgICBxdWFsaXR5X3Byb2JhYmlsaXRpZXM6IGVuYWJsZV9xdWFsaXR5LmNoZWNrZWQgPyBxdWFsaXR5IDogbnVsbCxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBSZXBvcHVsYXRlIHRhYmxlIGFuZCBjaGFuZ2Ugc3R5bGVcclxuICAgICAgICB0YWJsZV9jb21wb25lbnQucmVwb3B1bGF0ZVRhYmxlKHNldHRpbmdzKTtcclxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NOYW1lID0gc2Vhc29uX2lucHV0LnZhbHVlLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgIC8vIFNldCB0aGUgcXVhbGl0eSBzZXR0aW5nc1xyXG4gICAgICAgIC8vIFRPRE86IGdldCB0aGVzZSBlbGVtZW50cyBhaGVhZCBvZiB0aW1lLCBzdG9wIHF1ZXJ5aW5nIGV2ZXJ5IHRpbWVcclxuICAgICAgICBsZXQga2V5OiBrZXlvZiBRdWFsaXR5UHJvYmFiaWxpdGllcztcclxuICAgICAgICBmb3IgKGtleSBpbiBxdWFsaXR5KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgcGVyY2VudC0ke2tleX1gKSE7XHJcbiAgICAgICAgICAgIGNvbnN0IHBlcmNlbnQgPSAxMDAgKiBxdWFsaXR5W2tleV07XHJcbiAgICAgICAgICAgIGNlbGwudGV4dENvbnRlbnQgPSBgJHtwZXJjZW50LnRvRml4ZWQoMCl9JWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZlcmFnZS1xdWFsaXR5XCIpIS50ZXh0Q29udGVudCA9IHF1YWxpdHlfZmFjdG9yLnRvRml4ZWQoMik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUnVuIGl0IG9uY2UgdG8gYXBwbHkgdGhlIGRlZmF1bHQgc2V0dGluZ3MuXHJcbiAgICByZWFkQW5kQXBwbHlTZXR0aW5ncygpO1xyXG5cclxuICAgIC8vIEF0dGFjaCBldmVudCBsaXN0ZW5lcnNcclxuICAgIGlucHV0X3BhbmVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgcmVhZEFuZEFwcGx5U2V0dGluZ3MoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuLy8gQWxyaWdodHksIHdlJ3JlIHJlYWR5IHRvIGdvISBXYWl0IGZvciB0aGUgRE9NIHRvIGZpbmlzaCBsb2FkaW5nIChvciBzZWUgaWYgaXRcclxuLy8gYWxyZWFkeSBoYXMuXHJcbmlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIikge1xyXG4gICAgLy8gTG9hZGluZyBoYXNuJ3QgZmluaXNoZWQgeWV0XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBpbml0aWFsaXplKTtcclxufSBlbHNlIHtcclxuICAgIC8vIGBET01Db250ZW50TG9hZGVkYCBoYXMgYWxyZWFkeSBmaXJlZFxyXG4gICAgaW5pdGlhbGl6ZSgpO1xyXG59Il0sIm5hbWVzIjpbIlNlYXNvbiIsImZyb21TdHJpbmciLCJzIiwidG9VcHBlckNhc2UiLCJTUFJJTkciLCJTVU1NRVIiLCJGQUxMIiwiV0lOVEVSIiwiRXJyb3IiLCJTSUxWRVJfTVVMVElQTElFUiIsIkdPTERfTVVMVElQTElFUiIsIklSSURJVU1fTVVMVElQTElFUiIsImNhbGN1bGF0ZSIsImNyb3AiLCJzZXR0aW5ncyIsInNlYXNvbnMiLCJudW1fc2Vhc29ucyIsIm11bHRpc2Vhc29uIiwiaSIsInB1c2giLCJzZWFzb24iLCJ2YWx1ZU9mIiwiaW5jbHVkZXMiLCJkYXlzX2xlZnQiLCJtdWx0aXNlYXNvbl9lbmFibGVkIiwibGVuZ3RoIiwiaW5kZXhPZiIsInN0YXJ0X2RheSIsIm51bV9oYXJ2ZXN0cyIsInVzZWZ1bF9kYXlzIiwiZGF5c190b19ncm93IiwicmVncm93dGhfcGVyaW9kIiwiZXh0cmFfaGFydmVzdHMiLCJNYXRoIiwiZmxvb3IiLCJiYXNlX3ByaWNlIiwic2VsbF9wcmljZSIsInF1YWxpdHlfcHJpY2UiLCJxdWFsaXR5X3Byb2JhYmlsaXRpZXMiLCJxIiwibm9ybWFsIiwic2lsdmVyIiwiZ29sZCIsImlyaWRpdW0iLCJtYXAiLCJtdWx0aXBsaWVyIiwicCIsInRydW5jIiwicmVkdWNlIiwiYSIsImIiLCJudW1fY3JvcHNfcGVyX2hhcnZlc3QiLCJ5aWVsZCIsInBlcmNlbnRfY2hhbmNlX2V4dHJhIiwicHJvZml0Iiwic2VlZF9jb3N0IiwiZGVmaW5pdGlvbiIsIm51bV9jcm9wcyIsImRhaWx5X3Byb2ZpdCIsIkNPTFVNTlMiLCJuYW1lIiwiY2VsbFRleHQiLCJjb21wYXJlIiwibG9jYWxlQ29tcGFyZSIsInRvU3RyaW5nIiwidW5kZWZpbmVkIiwieWllbGRfbnVtIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwidG9GaXhlZCIsImlzRmluaXRlIiwiQ3JvcFJvdyIsImNvbnN0cnVjdG9yIiwicm93IiwiZGF0YSIsInRoaXMiLCJjb2wiLCJ2YWx1ZSIsImluc2VydENlbGwiLCJhcHBlbmRDaGlsZCIsImRvY3VtZW50IiwiY3JlYXRlVGV4dE5vZGUiLCJmbGlwRGlyZWN0aW9uIiwieCIsIkNyb3BUYWJsZSIsInRhYmxlIiwicm93cyIsImN1cnJlbnRfc29ydCIsInRoZWFkIiwiY3JlYXRlVEhlYWQiLCJ0Ym9keSIsImNyZWF0ZVRCb2R5IiwiaW5zZXJ0Um93IiwiaWR4IiwiZW50cmllcyIsImNlbGwiLCJhZGRFdmVudExpc3RlbmVyIiwiZGlyIiwiaGVhZGVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJoZWFkZXIiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJzb3J0Um93cyIsInJlcG9wdWxhdGVUYWJsZSIsInJlcGxhY2VDaGlsZHJlbiIsImRlZiIsInNvcnQiLCJpbml0aWFsaXplIiwiY29uc29sZSIsImxvZyIsImdldEVsZW1lbnRCeUlkIiwiSFRNTFRhYmxlRWxlbWVudCIsImlucHV0X3BhbmVsIiwic2Vhc29uX2lucHV0IiwicXVlcnlTZWxlY3RvciIsImN1cnJlbnRfZGF5X2lucHV0IiwiZW5hYmxlX211bHRpc2Vhc29uIiwiZW5hYmxlX3F1YWxpdHkiLCJmYXJtaW5nX2xldmVsX2lucHV0IiwidGFibGVfY29tcG9uZW50IiwicmVhZEFuZEFwcGx5U2V0dGluZ3MiLCJxdWFsaXR5IiwiZmFybWluZ19sZXZlbCIsInBfZ29sZF9jb2luIiwicF9pcmlkaXVtX2NvaW4iLCJtaW4iLCJjb21wdXRlUXVhbGl0eSIsInZhbHVlQXNOdW1iZXIiLCJxdWFsaXR5X2ZhY3RvciIsImNoZWNrZWQiLCJrZXkiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGFzc05hbWUiLCJ0b0xvd2VyQ2FzZSIsInBlcmNlbnQiLCJ0ZXh0Q29udGVudCIsImV2ZW50IiwicmVhZHlTdGF0ZSJdLCJzb3VyY2VSb290IjoiIn0=